<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V∆∞·ªùn R·ª±c R·ª° - Game N√¥ng Tr·∫°i Th·∫ßn K·ª≥</title>
    <meta name="description" content="Kh√°m ph√° th·∫ø gi·ªõi th·∫ßn k·ª≥ c·ªßa V∆∞·ªùn R·ª±c R·ª° - game n√¥ng tr·∫°i v·ªõi c·ªët truy·ªán s√¢u s·∫Øc v·ªÅ s·ª± tha th·ª© v√† h·ªìi sinh">
    <meta name="keywords" content="game n√¥ng tr·∫°i, v∆∞·ªùn r·ª±c r·ª°, unity game, farming game, vietnam game">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="V∆∞·ªùn R·ª±c R·ª° - Game N√¥ng Tr·∫°i Th·∫ßn K·ª≥">
    <meta property="og:description" content="Kh√°m ph√° th·∫ø gi·ªõi th·∫ßn k·ª≥ c·ªßa V∆∞·ªùn R·ª±c R·ª° v·ªõi c·ªët truy·ªán s√¢u s·∫Øc v·ªÅ s·ª± tha th·ª© v√† h·ªìi sinh">
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:image" content="images/og-image.jpg">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="img/logo/ChatGPT Image 13_27_39 3 thg 9, 2025.png">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- SweetAlert2 -->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.1/dist/sweetalert2.min.css" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/landing-styles.css">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID');
    </script>
</head>
<body>
    <!-- Scroll Progress Bar -->
    <div class="scroll-progress" id="scrollProgress"></div>
    
    <!-- Background Music -->
    <audio id="backgroundMusic" preload="auto" loop>
        <source src="music/B√≥ng T·ªëi Tham Lam.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    
    <!-- Music Control Button -->
    <div class="music-control">
        <button id="musicToggle" class="music-btn" onclick="toggleMusic()" title="B·∫≠t/T·∫Øt nh·∫°c n·ªÅn">
            <i class="fas fa-volume-up" id="musicIcon"></i>
        </button>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="img/logo/ChatGPT Image 13_27_39 3 thg 9, 2025.png" alt="V∆∞·ªùn R·ª±c R·ª° Logo">
                <span>V∆∞·ªùn R·ª±c R·ª°</span>
            </div>
            <ul class="nav-menu">
                <!-- <li><a href="#home" class="nav-link">Trang ch·ªß</a></li>
                <li><a href="#story" class="nav-link">C·ªët truy·ªán</a></li>
                <li><a href="#features" class="nav-link">T√≠nh nƒÉng</a></li>
                <li><a href="#gallery" class="nav-link">H√¨nh ·∫£nh</a></li>
                <li><a href="#gameplay" class="nav-link">H∆∞·ªõng d·∫´n</a></li> -->
                <!-- <li><a href="#download" class="nav-link">T·∫£i game</a></li> -->
                <!-- <li><a href="#contact" class="nav-link">Li√™n h·ªá</a></li> -->
                <li class="nav-login">
                    <button class="login-btn" onclick="openLoginModal()">
                        <i class="fas fa-user"></i>
                        ƒêƒÉng nh·∫≠p
                    </button>
                </li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-background">
            <video autoplay muted loop playsinline class="hero-video" style="background: red;" onloadstart="console.log('Video loading...')" oncanplay="console.log('Video can play')" onerror="console.log('Video error')">
                <source src="video/lv_0_20250915023633.mp4" type="video/mp4">
                <source src="video/0911.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
        <div class="hero-content">
            <div class="hero-text">
                <h1 class="hero-title">
                    <span class="title-main">V∆∞·ªùn R·ª±c R·ª°</span>
                    <span class="title-sub">Game N√¥ng Tr·∫°i Th·∫ßn K·ª≥</span>
                </h1>
                <p class="hero-description">
                    Kh√°m ph√° th·∫ø gi·ªõi th·∫ßn k·ª≥ n∆°i m√†u s·∫Øc v√† h·∫°nh ph√∫c ƒë∆∞·ª£c h·ªìi sinh. 
                    C√πng T√≠ T·∫πo gieo tr·ªìng, chƒÉm s√≥c v√† mang l·∫°i √°nh s√°ng cho L√†ng Hoa R·ª±c.
                </p>
                <div class="hero-buttons">
                    <button class="btn btn-primary" onclick="downloadGame(); trackEvent('download_click', 'hero_section')">
                        <i class="fab fa-windows"></i>
                        <!-- <i class="fas fa-download"></i> -->
                        T·∫£i Game Mi·ªÖn Ph√≠
                    </button>
                    <button class="btn btn-secondary" onclick="openVideoModal(); trackEvent('trailer_click', 'hero_section')">
                        <i class="fas fa-play"></i>
                        Xem Trailer
                    </button>
                </div>
                <!-- <div class="hero-stats">
                    <div class="stat-item">
                        <span class="stat-number">10K+</span>
                        <span class="stat-label">Ng∆∞·ªùi ch∆°i</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">4.8</span>
                        <span class="stat-label">ƒê√°nh gi√°</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">50+</span>
                        <span class="stat-label">Lo·∫°i hoa</span>
                    </div>
                </div> -->
            </div>
            <div class="hero-image">
                <div class="game-preview">
                    <div class="advanced-carousel">
                        <div class="carousel-wrapper">
                            <div class="carousel-track" id="carouselTrack">
                                <div class="carousel-item active" data-index="0">
                                    <img src="images/m·ª• th·∫£o.png" alt="M·ª• Th·∫£o" class="carousel-img">
                                    <div class="item-overlay">
                                        <h4>M·ª• Th·∫£o</h4>
                                        <p>Gi√† l√†ng</p>
                                    </div>
                                </div>
                                <div class="carousel-item" data-index="1">
                                    <img src="images/t√≠ n·ªã n·ªØ.png" alt="T√≠ N·ªã N·ªØ" class="carousel-img">
                                    <div class="item-overlay">
                                        <h4>T√≠ N·ªã N·ªØ</h4>
                                        <p>Nh√¢n v·∫≠t ch√≠nh</p>
                                    </div>
                                </div>
                                <div class="carousel-item" data-index="2">
                                    <img src="images/tinh linh.png" alt="Tinh Linh" class="carousel-img">
                                    <div class="item-overlay">
                                        <h4>Tinh Linh</h4>
                                        <p>Tinh linh c√¢y pha l√™</p>
                                    </div>
                                </div>
                                <div class="carousel-item" data-index="3">
                                    <img src="images/m·ª• x√°m.png" alt="M·ª• X√°m" class="carousel-img">
                                    <div class="item-overlay">
                                        <h4>M·ª• X√°m</h4>
                                        <p>Ph√π th·ªßy t√†i nƒÉng</p>
                                    </div>
                                </div>
                                <div class="carousel-item" data-index="4">
                                    <img src="img/z7056398979903_dffe5cadf073b176003b5973aaa62961.jpg" alt="Scylla Cambell" class="carousel-img">
                                    <div class="item-overlay">
                                        <h4>Scylla Cambell</h4>
                                        <p>Ch·ªß hi·ªáp h√¥i m·∫°o hi·ªÉm</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Navigation Controls -->
                        <div class="carousel-controls">
                            <button class="carousel-nav prev" id="prevBtn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="carousel-nav next" id="nextBtn">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        
                        <!-- Progress Bar -->
                        <div class="carousel-progress">
                            <div class="progress-bar" id="progressBar"></div>
                        </div>
                        
                        <!-- Dots Indicator -->
                        <div class="carousel-dots" id="carouselDots">
                            <span class="dot active" data-slide="0"></span>
                            <span class="dot" data-slide="1"></span>
                            <span class="dot" data-slide="2"></span>
                            <span class="dot" data-slide="3"></span>
                            <span class="dot" data-slide="4"></span>
                        </div>
                    </div>
                    
                    <!-- <div class="floating-elements">
                        <div class="floating-flower flower-1">üå∏</div>
                        <div class="floating-flower flower-2">üå∫</div>
                        <div class="floating-flower flower-3">üåª</div>
                        <div class="floating-flower flower-4">üå∑</div>
                    </div> -->
                </div>
            </div>
        </div>
    </section>

    <!-- Video Trailer Modal -->
    <div id="videoModal" class="video-modal">
        <div class="video-modal-overlay" onclick="closeVideoModal()"></div>
        <div class="video-modal-content">
            <button class="video-close-btn" onclick="closeVideoModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="video-container">
                <video id="trailerVideo" controls preload="metadata">
                    <source src="video/0911.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <div class="video-info">
                <h3>Game Trailer - V∆∞·ªùn R·ª±c R·ª°</h3>
                <p>Kh√°m ph√° th·∫ø gi·ªõi th·∫ßn k·ª≥ ƒë·∫ßy m√†u s·∫Øc v√† ph√©p thu·∫≠t</p>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="login-modal">
        <div class="login-modal-overlay" onclick="closeLoginModal()"></div>
        <div class="login-modal-content">
            <button class="login-close-btn" onclick="closeLoginModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="login-container">
                <div class="login-header">
                    <img src="img/logo/ChatGPT Image 13_27_39 3 thg 9, 2025.png" alt="Logo" class="login-logo">
                    <h2>ƒêƒÉng nh·∫≠p</h2>
                    <p>Ch√†o m·ª´ng tr·ªü l·∫°i v·ªõi V∆∞·ªùn R·ª±c R·ª°!</p>
                </div>
                <form class="login-form" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label for="username">Email:</label>
                        <input type="email" id="username" name="username" required placeholder="example@email.com">
                        <i class="fas fa-envelope input-icon"></i>
                    </div>
                    <div class="form-group">
                        <label for="password">M·∫≠t kh·∫©u:</label>
                        <input type="password" id="password" name="password" required>
                        <i class="fas fa-lock input-icon"></i>
                        <i class="fas fa-eye password-toggle" onclick="togglePassword()"></i>
                    </div>
                    <div class="form-options">
                        <label class="checkbox-label">
                            <input type="checkbox" id="remember">
                            <span class="checkmark"></span>
                            Ghi nh·ªõ ƒëƒÉng nh·∫≠p
                        </label>
                        <a href="#" class="forgot-password" onclick="openForgotPasswordModal()">Qu√™n m·∫≠t kh·∫©u?</a>
                    </div>
                    <button type="submit" class="login-submit-btn">
                        <i class="fas fa-sign-in-alt"></i>
                        ƒêƒÉng nh·∫≠p
                    </button>
                </form>
                <div class="login-divider">
                    <span>ho·∫∑c</span>
                </div>
                <div class="social-login">
                    <button class="social-btn google-btn" onclick="loginWithGoogle()">
                        <i class="fab fa-google"></i>
                        ƒêƒÉng nh·∫≠p v·ªõi Google
                    </button>
                </div>
                <div class="login-footer">
                    <p>Ch∆∞a c√≥ t√†i kho·∫£n? <a href="#" onclick="openRegisterModal()">ƒêƒÉng k√Ω ngay</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="login-modal">
        <div class="login-modal-overlay" onclick="closeRegisterModal()"></div>
        <div class="login-modal-content">
            <button class="login-close-btn" onclick="closeRegisterModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="login-container">
                <div class="login-header">
                    <img src="img/logo/ChatGPT Image 13_27_39 3 thg 9, 2025.png" alt="Logo" class="login-logo">
                    <h2>ƒêƒÉng k√Ω t√†i kho·∫£n</h2>
                    <p>T·∫°o t√†i kho·∫£n ƒë·ªÉ kh√°m ph√° V∆∞·ªùn R·ª±c R·ª°!</p>
                </div>
                <form class="login-form" onsubmit="handleRegister(event)">
                    <div class="form-group">
                        <label for="reg-fullname">H·ªç v√† t√™n:</label>
                        <input type="text" id="reg-fullname" name="fullname" required>
                        <i class="fas fa-user input-icon"></i>
                    </div>
                    <div class="form-group">
                        <label for="reg-email">Email:</label>
                        <input type="email" id="reg-email" name="email" required>
                        <i class="fas fa-envelope input-icon"></i>
                    </div>
                    <div class="form-group">
                        <label for="reg-username">T√™n ƒëƒÉng nh·∫≠p:</label>
                        <input type="text" id="reg-username" name="username" required>
                        <i class="fas fa-user-circle input-icon"></i>
                    </div>
                    <div class="form-group">
                        <label for="reg-password">M·∫≠t kh·∫©u:</label>
                        <input type="password" id="reg-password" name="password" required>
                        <i class="fas fa-lock input-icon"></i>
                        <i class="fas fa-eye password-toggle" onclick="toggleRegisterPassword()"></i>
                    </div>
                    <div class="form-group">
                        <label for="reg-confirm-password">X√°c nh·∫≠n m·∫≠t kh·∫©u:</label>
                        <input type="password" id="reg-confirm-password" name="confirmPassword" required>
                        <i class="fas fa-lock input-icon"></i>
                        <i class="fas fa-eye password-toggle" onclick="toggleConfirmPassword()"></i>
                    </div>
                    <div class="form-options">
                        <label class="checkbox-label">
                            <input type="checkbox" id="agree-terms" required>
                            <span class="checkmark"></span>
                            T√¥i ƒë·ªìng √Ω v·ªõi <a href="#" onclick="openTermsModal()">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a>
                        </label>
                    </div>
                    <button type="submit" class="login-submit-btn">
                        <i class="fas fa-user-plus"></i>
                        T·∫°o t√†i kho·∫£n
                    </button>
                </form>
                <div class="login-divider">
                    <span>ho·∫∑c</span>
                </div>
                <div class="social-login">
                    <button class="social-btn google-btn" onclick="registerWithGoogle()">
                        <i class="fab fa-google"></i>
                        ƒêƒÉng k√Ω v·ªõi Google
                    </button>
                </div>
                <div class="login-footer">
                    <p>ƒê√£ c√≥ t√†i kho·∫£n? <a href="#" onclick="openLoginFromRegister()">ƒêƒÉng nh·∫≠p ngay</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div id="forgotPasswordModal" class="login-modal">
        <div class="login-modal-overlay" onclick="closeForgotPasswordModal()"></div>
        <div class="login-modal-content">
            <button class="login-close-btn" onclick="closeForgotPasswordModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="login-container">
                <div class="login-header">
                    <img src="img/logo/ChatGPT Image 13_27_39 3 thg 9, 2025.png" alt="Logo" class="login-logo">
                    <h2>Qu√™n m·∫≠t kh·∫©u</h2>
                    <p>Nh·∫≠p email ƒë·ªÉ kh√¥i ph·ª•c m·∫≠t kh·∫©u c·ªßa b·∫°n</p>
                </div>
                <form class="login-form" onsubmit="handleForgotPassword(event)">
                    <div class="form-group">
                        <label for="forgot-email">Email c·ªßa b·∫°n:</label>
                        <input type="email" id="forgot-email" name="email" required placeholder="example@email.com">
                        <i class="fas fa-envelope input-icon"></i>
                    </div>
                    <button type="submit" class="login-submit-btn">
                        <i class="fas fa-paper-plane"></i>
                        G·ª≠i link kh√¥i ph·ª•c
                    </button>
                </form>
                <div class="login-footer" style="border-top: none; padding-top: 15px;">
                    <p>Nh·ªõ l·∫°i m·∫≠t kh·∫©u? <a href="#" onclick="openLoginFromForgot()">ƒêƒÉng nh·∫≠p</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Password Reset Success Modal -->
    <div id="resetSuccessModal" class="login-modal">
        <div class="login-modal-overlay" onclick="closeResetSuccessModal()"></div>
        <div class="login-modal-content">
            <button class="login-close-btn" onclick="closeResetSuccessModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="login-container">
                <div class="login-header">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2>Email ƒë√£ ƒë∆∞·ª£c g·ª≠i!</h2>
                    <p>Vui l√≤ng ki·ªÉm tra email c·ªßa b·∫°n ƒë·ªÉ nh·∫≠n link kh√¥i ph·ª•c m·∫≠t kh·∫©u</p>
                </div>
                <div class="success-content">
                    <div class="info-box">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>L∆∞u √Ω:</strong>
                            <ul>
                                <li>Ki·ªÉm tra c·∫£ th∆∞ m·ª•c spam/junk</li>
                                <li>Link s·∫Ω h·∫øt h·∫°n sau 1 gi·ªù</li>
                                <li>N·∫øu kh√¥ng nh·∫≠n ƒë∆∞·ª£c email, th·ª≠ l·∫°i sau 5 ph√∫t</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="login-footer" style="border-top: none;">
                    <button class="login-submit-btn" onclick="closeResetSuccessModal()">
                        <i class="fas fa-arrow-left"></i>
                        Quay l·∫°i ƒëƒÉng nh·∫≠p
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.1/dist/sweetalert2.all.min.js"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import Firebase SDK from CDN
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';
        import { 
            getAuth, 
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut,
            sendPasswordResetEmail,
            GoogleAuthProvider,
            signInWithPopup,
            updateProfile,
            onAuthStateChanged
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { 
            getFirestore, 
            doc, 
            setDoc, 
            getDoc,
            collection,
            query,
            where,
            getDocs
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDA2nXjMUZu7IcTmQIg3uNgJdb8PBWy618",
            authDomain: "trangtrai-2769b.firebaseapp.com",
            databaseURL: "https://trangtrai-2769b-default-rtdb.firebaseio.com",
            projectId: "trangtrai-2769b",
            storageBucket: "trangtrai-2769b.firebasestorage.app",
            messagingSenderId: "455581137012",
            appId: "1:455581137012:web:4f3c2a5c8fe7d1a4b3b921",
            measurementId: "G-3RWSR0ZC1G"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Make Firebase available globally
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        
        console.log('üî• Firebase initialized successfully!');
    </script>
    <script type="module" src="js/firebase-auth.js"></script>
    
    <!-- Scripts -->
    <script src="js/landing-script.js"></script>
    
    <!-- Debug Script for Carousel -->
    <script>
        // Ki·ªÉm tra carousel sau khi page load
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('üîç Ki·ªÉm tra carousel status...');
                const carouselItems = document.querySelectorAll('.carousel-item');
                const dots = document.querySelectorAll('.dot');
                
                console.log('Carousel items found:', carouselItems.length);
                console.log('Dots found:', dots.length);
                console.log('Carousel instance:', window.advancedHeroCarousel);
                
                if (window.advancedHeroCarousel) {
                    console.log('‚úÖ Carousel ho·∫°t ƒë·ªông:', window.advancedHeroCarousel.isAutoPlaying);
                } else {
                    console.warn('‚ùå Carousel ch∆∞a ƒë∆∞·ª£c kh·ªüi t·∫°o!');
                }
            }, 2000);
        });
        
        // Manual controls for debugging
        function debugCarousel() {
            if (window.advancedHeroCarousel) {
                console.log('Current index:', window.advancedHeroCarousel.currentIndex);
                console.log('Total items:', window.advancedHeroCarousel.totalItems);
                console.log('AutoPlay status:', window.advancedHeroCarousel.isAutoPlaying);
                window.advancedHeroCarousel.nextSlide();
            }
        }
        
        // Timeline functions removed - no longer needed
        
        // SweetAlert2 Helper Functions
        function showSuccessAlert(title, text, callback) {
            Swal.fire({
                icon: 'success',
                title: title,
                text: text,
                confirmButtonText: 'Tuy·ªát v·ªùi!',
                confirmButtonColor: '#4a90e2',
                background: '#ffffff',
                color: '#333333',
                showConfirmButton: true,
                timer: 3000,
                timerProgressBar: true,
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button'
                }
            }).then((result) => {
                if (callback) callback(result);
            });
        }
        
        function showErrorAlert(title, text, callback) {
            Swal.fire({
                icon: 'error',
                title: title,
                text: text,
                confirmButtonText: 'Th·ª≠ l·∫°i',
                confirmButtonColor: '#ff6b6b',
                background: '#ffffff',
                color: '#333333',
                showConfirmButton: true,
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button-error'
                }
            }).then((result) => {
                if (callback) callback(result);
            });
        }
        
        function showWarningAlert(title, text, callback) {
            Swal.fire({
                icon: 'warning',
                title: title,
                text: text,
                confirmButtonText: 'ƒê√£ hi·ªÉu',
                confirmButtonColor: '#ffa726',
                background: '#ffffff',
                color: '#333333',
                showConfirmButton: true,
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button-warning'
                }
            }).then((result) => {
                if (callback) callback(result);
            });
        }
        
        function showInfoAlert(title, text, callback) {
            Swal.fire({
                icon: 'info',
                title: title,
                text: text,
                confirmButtonText: 'OK',
                confirmButtonColor: '#4a90e2',
                background: '#ffffff',
                color: '#333333',
                showConfirmButton: true,
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button'
                }
            }).then((result) => {
                if (callback) callback(result);
            });
        }
        
        function showConfirmAlert(title, text, confirmCallback, cancelCallback) {
            Swal.fire({
                icon: 'question',
                title: title,
                text: text,
                showCancelButton: true,
                confirmButtonText: 'ƒê·ªìng √Ω',
                cancelButtonText: 'H·ªßy b·ªè',
                confirmButtonColor: '#4a90e2',
                cancelButtonColor: '#6c757d',
                background: '#ffffff',
                color: '#333333',
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button',
                    cancelButton: 'custom-swal-button-cancel'
                }
            }).then((result) => {
                if (result.isConfirmed && confirmCallback) {
                    confirmCallback(result);
                } else if (result.isDismissed && cancelCallback) {
                    cancelCallback(result);
                }
            });
        }
        
        function showLoadingAlert(title, text) {
            Swal.fire({
                title: title,
                text: text,
                allowOutsideClick: false,
                allowEscapeKey: false,
                showConfirmButton: false,
                background: '#ffffff',
                color: '#333333',
                didOpen: () => {
                    Swal.showLoading();
                },
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title'
                }
            });
        }
        
        function closeLoadingAlert() {
            Swal.close();
        }
        
        // Download Game Function
        function downloadGame() {
            // Show loading alert
            showLoadingAlert('ƒêang chu·∫©n b·ªã t·∫£i xu·ªëng...', 'Vui l√≤ng ch·ªù trong gi√¢y l√°t...');
            
            // Simulate preparation time (2 seconds)
            setTimeout(() => {
                closeLoadingAlert();
                
                // Show download confirmation with file info
                Swal.fire({
                    icon: 'info',
                    title: 'T·∫£i xu·ªëng V∆∞·ªùn R·ª±c R·ª°',
                    html: `
                        <div style="text-align: left; margin: 20px 0;">
                            <p><strong>T√™n file:</strong> vuonrucro.rar</p>
                            <p><strong>K√≠ch th∆∞·ªõc:</strong> ~500MB</p>
                            <p><strong>H·ªá ƒëi·ªÅu h√†nh:</strong> Windows 10/11</p>
                            <p><strong>Y√™u c·∫ßu:</strong> DirectX 11, RAM 4GB</p>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                            <small><i class="fas fa-info-circle"></i> T·∫£i xu·ªëng s·∫Ω b·∫Øt ƒë·∫ßu t·ª± ƒë·ªông sau khi b·∫•m "T·∫£i ngay"</small>
                        </div>
                    `,
                    showCancelButton: true,
                    confirmButtonText: '<i class="fas fa-download"></i> T·∫£i ngay',
                    cancelButtonText: 'H·ªßy',
                    confirmButtonColor: '#4a90e2',
                    cancelButtonColor: '#6c757d',
                    customClass: {
                        popup: 'custom-swal-popup',
                        title: 'custom-swal-title',
                        confirmButton: 'custom-swal-button',
                        cancelButton: 'custom-swal-button-cancel'
                    }
                }).then((result) => {
                    if (result.isConfirmed) {
                        // Start actual download
                        startDownload();
                    }
                });
            }, 2000);
        }
        
        function startDownload() {
            try {
                // Create download link
                const link = document.createElement('a');
                link.href = 'game/vuonrucro.rar'; // Path to your game file
                link.download = 'vuonrucro.rar';
                link.style.display = 'none';
                
                // Add to DOM, click, and remove
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Show success message
                showSuccessAlert(
                    'T·∫£i xu·ªëng ƒë√£ b·∫Øt ƒë·∫ßu!', 
                    'File vuonrucro.rar ƒëang ƒë∆∞·ª£c t·∫£i v·ªÅ m√°y t√≠nh c·ªßa b·∫°n. Ki·ªÉm tra th∆∞ m·ª•c Downloads ƒë·ªÉ gi·∫£i n√©n v√† c√†i ƒë·∫∑t game.',
                    () => {
                        // Show installation guide
                        showInstallationGuide();
                    }
                );
                
                // Track download event
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'download', {
                        event_category: 'Game',
                        event_label: 'vuonrucro.rar',
                        value: 1
                    });
                }
                
            } catch (error) {
                console.error('Download error:', error);
                showErrorAlert(
                    'L·ªói t·∫£i xu·ªëng!', 
                    'Kh√¥ng th·ªÉ t·∫£i file. Vui l√≤ng th·ª≠ l·∫°i sau ho·∫∑c li√™n h·ªá h·ªó tr·ª£.'
                );
            }
        }
        
        function showInstallationGuide() {
            Swal.fire({
                icon: 'info',
                title: 'H∆∞·ªõng d·∫´n c√†i ƒë·∫∑t',
                html: `
                    <div style="text-align: left; margin: 20px 0;">
                        <h4>C√°c b∆∞·ªõc c√†i ƒë·∫∑t:</h4>
                        <ol style="margin: 15px 0; padding-left: 20px;">
                            <li>T√¨m file <strong>vuonrucro.rar</strong> trong th∆∞ m·ª•c Downloads</li>
                            <li>Gi·∫£i n√©n file b·∫±ng WinRAR ho·∫∑c 7-Zip</li>
                            <li>Ch·∫°y file <strong>VuonRucRo.exe</strong> v·ªõi quy·ªÅn Administrator</li>
                            <li>L√†m theo h∆∞·ªõng d·∫´n c√†i ƒë·∫∑t</li>
                            <li>Th∆∞·ªüng th·ª©c game!</li>
                        </ol>
                        
                        <h4>L∆∞u √Ω:</h4>
                        <ul style="margin: 15px 0; padding-left: 20px;">
                            <li>ƒê·∫£m b·∫£o m√°y t√≠nh c√≥ DirectX 11</li>
                            <li>RAM t·ªëi thi·ªÉu 4GB</li>
                            <li>Dung l∆∞·ª£ng tr·ªëng √≠t nh·∫•t 2GB</li>
                        </ul>
                    </div>
                `,
                confirmButtonText: 'ƒê√£ hi·ªÉu',
                confirmButtonColor: '#4a90e2',
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button'
                }
            });
        }
        
        // Login Modal Functions
        function openLoginModal() {
            const modal = document.getElementById('loginModal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
            // Focus on username field
            setTimeout(() => {
                document.getElementById('username').focus();
            }, 100);
        }
        
        function closeLoginModal() {
            const modal = document.getElementById('loginModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            // Reset form
            document.querySelector('.login-form').reset();
        }
        
        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const toggleIcon = document.querySelector('.password-toggle');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
            }
        }
        
        async function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('username').value; // Changed to email
            const password = document.getElementById('password').value;
            const remember = document.getElementById('remember').checked;
            const submitBtn = event.target.querySelector('.login-submit-btn');
            
            // Basic validation
            if (!email || !password) {
                showError('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!', 'loginModal');
                return;
            }
            
            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showError('Vui l√≤ng nh·∫≠p email h·ª£p l·ªá!', 'loginModal');
                return;
            }
            
            showLoading(submitBtn);
            
            try {
                const result = await window.firebaseAuth.login(email, password);
                
                if (result.success) {
                    showSuccessAlert('ƒêƒÉng nh·∫≠p th√†nh c√¥ng!', 'Ch√†o m·ª´ng b·∫°n quay tr·ªü l·∫°i v·ªõi V∆∞·ªùn R·ª±c R·ª°!', () => {
                        closeLoginModal();
                    });
                } else {
                    showErrorAlert('ƒêƒÉng nh·∫≠p th·∫•t b·∫°i!', result.message);
                }
            } catch (error) {
                showErrorAlert('L·ªói h·ªá th·ªëng!', 'ƒê√£ c√≥ l·ªói x·∫£y ra! Vui l√≤ng th·ª≠ l·∫°i sau.');
                console.error('Login error:', error);
            } finally {
                hideLoading(submitBtn);
            }
        }
        
        async function loginWithGoogle() {
            try {
                const result = await window.firebaseAuth.loginWithGoogle();
                
                if (result.success) {
                    showSuccessAlert('ƒêƒÉng nh·∫≠p Google th√†nh c√¥ng!', 
                        'Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi V∆∞·ªùn R·ª±c R·ª°!', 
                        () => {
                            closeLoginModal();
                        });
                } else {
                    showErrorAlert('ƒêƒÉng nh·∫≠p Google th·∫•t b·∫°i!', result.message);
                }
            } catch (error) {
                showErrorAlert('L·ªói Google Authentication!', 'ƒê√£ c√≥ l·ªói x·∫£y ra khi ƒëƒÉng nh·∫≠p v·ªõi Google! Vui l√≤ng th·ª≠ l·∫°i.');
                console.error('Google login error:', error);
            }
        }
        
        // Register Modal Functions
        function openRegisterModal() {
            closeLoginModal();
            const modal = document.getElementById('registerModal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
            setTimeout(() => {
                document.getElementById('reg-fullname').focus();
            }, 100);
        }
        
        function closeRegisterModal() {
            const modal = document.getElementById('registerModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            document.querySelector('#registerModal .login-form').reset();
        }
        
        function openLoginFromRegister() {
            closeRegisterModal();
            openLoginModal();
        }
        
        function toggleRegisterPassword() {
            const passwordInput = document.getElementById('reg-password');
            const toggleIcon = passwordInput.parentElement.querySelector('.password-toggle');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
            }
        }
        
        function toggleConfirmPassword() {
            const passwordInput = document.getElementById('reg-confirm-password');
            const toggleIcon = passwordInput.parentElement.querySelector('.password-toggle');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
            }
        }
        
        async function handleRegister(event) {
            event.preventDefault();
            const fullname = document.getElementById('reg-fullname').value;
            const email = document.getElementById('reg-email').value;
            const username = document.getElementById('reg-username').value;
            const password = document.getElementById('reg-password').value;
            const confirmPassword = document.getElementById('reg-confirm-password').value;
            const agreeTerms = document.getElementById('agree-terms').checked;
            const submitBtn = event.target.querySelector('.login-submit-btn');
            
            // Validation
            if (!fullname || !email || !username || !password || !confirmPassword) {
                showWarningAlert('Th√¥ng tin ch∆∞a ƒë·∫ßy ƒë·ªß!', 'Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß t·∫•t c·∫£ c√°c tr∆∞·ªùng th√¥ng tin.');
                return;
            }
            
            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showWarningAlert('Email kh√¥ng h·ª£p l·ªá!', 'Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ email ƒë√∫ng ƒë·ªãnh d·∫°ng.');
                return;
            }
            
            // Username validation
            if (username.length < 3) {
                showWarningAlert('T√™n ƒëƒÉng nh·∫≠p qu√° ng·∫Øn!', 'T√™n ƒëƒÉng nh·∫≠p ph·∫£i c√≥ √≠t nh·∫•t 3 k√Ω t·ª±.');
                return;
            }
            
            // Password validation
            if (password.length < 6) {
                showWarningAlert('M·∫≠t kh·∫©u qu√° y·∫øu!', 'M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª± ƒë·ªÉ ƒë·∫£m b·∫£o b·∫£o m·∫≠t.');
                return;
            }
            
            if (password !== confirmPassword) {
                showWarningAlert('M·∫≠t kh·∫©u kh√¥ng kh·ªõp!', 'Vui l√≤ng ki·ªÉm tra v√† nh·∫≠p l·∫°i m·∫≠t kh·∫©u cho ch√≠nh x√°c.');
                return;
            }
            
            if (!agreeTerms) {
                showWarningAlert('Ch∆∞a ƒë·ªìng √Ω ƒëi·ªÅu kho·∫£n!', 'B·∫°n c·∫ßn ƒë·ªìng √Ω v·ªõi ƒëi·ªÅu kho·∫£n s·ª≠ d·ª•ng ƒë·ªÉ ti·∫øp t·ª•c ƒëƒÉng k√Ω.');
                return;
            }
            
            showLoading(submitBtn);
            
            try {
                const result = await window.firebaseAuth.register(email, password, fullname, username);
                
                if (result.success) {
                    showSuccessAlert('ƒêƒÉng k√Ω th√†nh c√¥ng!', 
                        `Ch√†o m·ª´ng ${fullname} ƒë·∫øn v·ªõi V∆∞·ªùn R·ª±c R·ª°! H√£y b·∫Øt ƒë·∫ßu kh√°m ph√° th·∫ø gi·ªõi th·∫ßn k·ª≥ c·ªßa ch√∫ng ta.`, 
                        () => {
                            closeRegisterModal();
                        });
                } else {
                    showErrorAlert('ƒêƒÉng k√Ω th·∫•t b·∫°i!', result.message);
                }
            } catch (error) {
                showErrorAlert('L·ªói h·ªá th·ªëng!', 'ƒê√£ c√≥ l·ªói x·∫£y ra trong qu√° tr√¨nh ƒëƒÉng k√Ω! Vui l√≤ng th·ª≠ l·∫°i sau.');
                console.error('Register error:', error);
            } finally {
                hideLoading(submitBtn);
            }
        }
        
        async function registerWithGoogle() {
            try {
                const result = await window.firebaseAuth.loginWithGoogle();
                
                if (result.success) {
                    showSuccessAlert('ƒêƒÉng k√Ω Google th√†nh c√¥ng!', 
                        'T√†i kho·∫£n c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng! Ch√†o m·ª´ng ƒë·∫øn v·ªõi V∆∞·ªùn R·ª±c R·ª°!', 
                        () => {
                            closeRegisterModal();
                        });
                } else {
                    showErrorAlert('ƒêƒÉng k√Ω Google th·∫•t b·∫°i!', result.message);
                }
            } catch (error) {
                showErrorAlert('L·ªói Google Authentication!', 'ƒê√£ c√≥ l·ªói x·∫£y ra khi ƒëƒÉng k√Ω v·ªõi Google! Vui l√≤ng th·ª≠ l·∫°i.');
                console.error('Google register error:', error);
            }
        }
        
        function openTermsModal() {
            showInfoAlert('ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng', 
                'B·∫±ng vi·ªác s·ª≠ d·ª•ng V∆∞·ªùn R·ª±c R·ª°, b·∫°n ƒë·ªìng √Ω tu√¢n th·ªß c√°c quy ƒë·ªãnh v·ªÅ b·∫£o m·∫≠t th√¥ng tin v√† s·ª≠ d·ª•ng d·ªãch v·ª• m·ªôt c√°ch c√≥ tr√°ch nhi·ªám. Chi ti·∫øt ƒë·∫ßy ƒë·ªß s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t s·ªõm.');
        }
        
        // Forgot Password Modal Functions
        function openForgotPasswordModal() {
            closeLoginModal();
            const modal = document.getElementById('forgotPasswordModal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
            setTimeout(() => {
                document.getElementById('forgot-email').focus();
            }, 100);
        }
        
        function closeForgotPasswordModal() {
            const modal = document.getElementById('forgotPasswordModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            document.querySelector('#forgotPasswordModal .login-form').reset();
        }
        
        function openLoginFromForgot() {
            closeForgotPasswordModal();
            openLoginModal();
        }
        
        async function handleForgotPassword(event) {
            event.preventDefault();
            const email = document.getElementById('forgot-email').value;
            const submitBtn = event.target.querySelector('.login-submit-btn');
            
            if (!email) {
                showWarningAlert('Thi·∫øu th√¥ng tin!', 'Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ email c·ªßa b·∫°n.');
                return;
            }
            
            // Validate email format
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showWarningAlert('Email kh√¥ng h·ª£p l·ªá!', 'Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ email ƒë√∫ng ƒë·ªãnh d·∫°ng.');
                return;
            }
            
            showLoading(submitBtn);
            
            try {
                const result = await window.firebaseAuth.resetPassword(email);
                
                if (result.success) {
                    showSuccessAlert('Email ƒë√£ ƒë∆∞·ª£c g·ª≠i!', 
                        'Ch√∫ng t√¥i ƒë√£ g·ª≠i link kh√¥i ph·ª•c m·∫≠t kh·∫©u ƒë·∫øn email c·ªßa b·∫°n. Vui l√≤ng ki·ªÉm tra h·ªôp th∆∞ (k·ªÉ c·∫£ th∆∞ m·ª•c spam).', 
                        () => {
                            closeForgotPasswordModal();
                        });
                } else {
                    showErrorAlert('G·ª≠i email th·∫•t b·∫°i!', result.message);
                }
            } catch (error) {
                showErrorAlert('L·ªói h·ªá th·ªëng!', 'ƒê√£ c√≥ l·ªói x·∫£y ra! Vui l√≤ng th·ª≠ l·∫°i sau.');
                console.error('Forgot password error:', error);
            } finally {
                hideLoading(submitBtn);
            }
        }
        
        // Reset Success Modal Functions
        function openResetSuccessModal() {
            const modal = document.getElementById('resetSuccessModal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        
        function closeResetSuccessModal() {
            const modal = document.getElementById('resetSuccessModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            openLoginModal();
        }
        
        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const loginModal = document.getElementById('loginModal');
            const registerModal = document.getElementById('registerModal');
            const forgotModal = document.getElementById('forgotPasswordModal');
            const successModal = document.getElementById('resetSuccessModal');
            
            if (event.target === loginModal) {
                closeLoginModal();
            } else if (event.target === registerModal) {
                closeRegisterModal();
            } else if (event.target === forgotModal) {
                closeForgotPasswordModal();
            } else if (event.target === successModal) {
                closeResetSuccessModal();
            }
        });
        
        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const loginModal = document.getElementById('loginModal');
                const registerModal = document.getElementById('registerModal');
                const forgotModal = document.getElementById('forgotPasswordModal');
                const successModal = document.getElementById('resetSuccessModal');
                
                if (loginModal.style.display === 'block') {
                    closeLoginModal();
                } else if (registerModal.style.display === 'block') {
                    closeRegisterModal();
                } else if (forgotModal.style.display === 'block') {
                    closeForgotPasswordModal();
                } else if (successModal.style.display === 'block') {
                    closeResetSuccessModal();
                }
            }
        });
        
        // Make functions globally available
        window.openLoginModal = openLoginModal;
        window.closeLoginModal = closeLoginModal;
        window.togglePassword = togglePassword;
        window.handleLogin = handleLogin;
        window.loginWithGoogle = loginWithGoogle;
        
        // Register functions
        window.openRegisterModal = openRegisterModal;
        window.closeRegisterModal = closeRegisterModal;
        window.openLoginFromRegister = openLoginFromRegister;
        window.toggleRegisterPassword = toggleRegisterPassword;
        window.toggleConfirmPassword = toggleConfirmPassword;
        window.handleRegister = handleRegister;
        window.registerWithGoogle = registerWithGoogle;
        window.openTermsModal = openTermsModal;
        
        // Forgot password functions
        window.openForgotPasswordModal = openForgotPasswordModal;
        window.closeForgotPasswordModal = closeForgotPasswordModal;
        window.openLoginFromForgot = openLoginFromForgot;
        window.handleForgotPassword = handleForgotPassword;
        window.openResetSuccessModal = openResetSuccessModal;
        window.closeResetSuccessModal = closeResetSuccessModal;
        
        // Expose debug functions globally
        window.debugCarousel = debugCarousel;
        
        // Make SweetAlert2 functions globally available
        window.showSuccessAlert = showSuccessAlert;
        window.showErrorAlert = showErrorAlert;
        window.showWarningAlert = showWarningAlert;
        window.showInfoAlert = showInfoAlert;
        window.showConfirmAlert = showConfirmAlert;
        window.showLoadingAlert = showLoadingAlert;
        window.closeLoadingAlert = closeLoadingAlert;
        
        // Download functions
        window.downloadGame = downloadGame;
        window.startDownload = startDownload;
        window.showInstallationGuide = showInstallationGuide;
        
        // Test functions
        console.log('üí° Available Commands:');
        console.log('- debugCarousel() - Check carousel status');
        console.log('- openLoginModal() - Open login modal');
        console.log('- downloadGame() - Test download game function');
        console.log('- showSuccessAlert() - Show success notification');
        console.log('- showErrorAlert() - Show error notification');
        console.log('- showWarningAlert() - Show warning notification');
    </script>
</body>
</html>
