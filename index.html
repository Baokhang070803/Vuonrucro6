<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L√†ng Hoa R·ª±c - Game N√¥ng Tr·∫°i Th·∫ßn K·ª≥</title>
    <meta name="description" content="Kh√°m ph√° th·∫ø gi·ªõi th·∫ßn k·ª≥ c·ªßa L√†ng Hoa R·ª±c - game n√¥ng tr·∫°i v·ªõi c·ªët truy·ªán s√¢u s·∫Øc v·ªÅ s·ª± tha th·ª© v√† h·ªìi sinh">
    <meta name="keywords" content="game n√¥ng tr·∫°i, l√†ng hoa r·ª±c, unity game, farming game, vietnam game">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="L√†ng Hoa R·ª±c - Game N√¥ng Tr·∫°i Th·∫ßn K·ª≥">
    <meta property="og:description" content="Kh√°m ph√° th·∫ø gi·ªõi th·∫ßn k·ª≥ c·ªßa L√†ng Hoa R·ª±c v·ªõi c·ªët truy·ªán s√¢u s·∫Øc v·ªÅ s·ª± tha th·ª© v√† h·ªìi sinh">
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:image" content="images/og-image.jpg">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="img/logo/ChatGPT Image 13_27_39 3 thg 9, 2025.png">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- SweetAlert2 -->
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.1/dist/sweetalert2.min.css" rel="stylesheet">
    
    <!-- AOS Animation Library -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/landing-styles.css">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID');
    </script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <video id="introVideo" autoplay muted playsinline>
            <source src="video/4k_cinematic_intro_202509290210 (online-video-cutter.com).mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>

    <!-- Scroll Progress Bar -->
    <div class="scroll-progress" id="scrollProgress"></div>
    
    <!-- Background Music -->
    <audio id="backgroundMusic" preload="auto" loop>
        <source src="music/B√≥ng T·ªëi Tham Lam.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    
    <!-- Music Control Button -->
    <div class="music-control">
        <button id="musicToggle" class="music-btn" onclick="toggleMusic()" title="B·∫≠t/T·∫Øt nh·∫°c n·ªÅn">
            <i class="fas fa-volume-up" id="musicIcon"></i>
        </button>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="img/logo/ChatGPT Image 13_27_39 3 thg 9, 2025.png" alt="L√†ng Hoa R·ª±c Logo">
                <span>L√†ng Hoa R·ª±c</span>
            </div>
            <ul class="nav-menu">
                <!-- <li><a href="#home" class="nav-link">Trang ch·ªß</a></li> -->
                <!-- <li><a href="#story" class="nav-link">C·ªët truy·ªán</a></li>
                <li><a href="#features" class="nav-link">T√≠nh nƒÉng</a></li>
                <li><a href="#gallery" class="nav-link">H√¨nh ·∫£nh</a></li>
                <li><a href="#gameplay" class="nav-link">H∆∞·ªõng d·∫´n</a></li> -->
                <!-- <li><a href="#download" class="nav-link">T·∫£i game</a></li> -->
                <!-- <li><a href="#contact" class="nav-link">Li√™n h·ªá</a></li> -->
                <li class="nav-login">
                    <button class="login-btn" onclick="openLoginModal()">
                        <i class="fas fa-user"></i>
                        ƒêƒÉng nh·∫≠p
                    </button>
                </li>
            </ul>
            <div class="hamburger">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-background">
            <video autoplay muted loop playsinline class="hero-video" style="background: rgb(255, 255, 255);" onloadstart="console.log('Video loading...')" oncanplay="console.log('Video can play')" onerror="console.log('Video error')">
                <source src="video/Fixed_camera_cinematic_202509290124.mp4" type="video/mp4">
                <source src="video/0911.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
        </div>
        <div class="hero-content">
            <div class="hero-text">
                <h1 class="hero-title">
                    <span class="title-main">L√†ng Hoa R·ª±c</span>
                    <span class="title-sub">Game N√¥ng Tr·∫°i Th·∫ßn K·ª≥</span>
                </h1>
                <p class="hero-description">
                    M·ªôt h√†nh tr√¨nh ƒë·∫ßy m√†u s·∫Øc v·ªÅ s·ª± tha th·ª©, h·ªìi sinh v√† t√¨nh y√™u thi√™n nhi√™n. 
                    C√πng T√≠ N·ªã kh√°m ph√° th·∫ø gi·ªõi th·∫ßn k·ª≥ v√† mang l·∫°i √°nh s√°ng cho L√†ng Hoa R·ª±c.
                </p>
                <div class="hero-buttons">
                    <button class="btn btn-primary" onclick="downloadGame(); trackEvent('download_click', 'hero_section')">
                        <i class="fab fa-windows"></i>
                        <!-- <i class="fas fa-download"></i> -->
                        T·∫£i Game Mi·ªÖn Ph√≠
                    </button>
                    <button class="btn btn-secondary" onclick="openVideoModal(); trackEvent('trailer_click', 'hero_section')">
                        <i class="fas fa-play"></i>
                        Xem Trailer
                    </button>
                </div>
                <div class="scroll-indicator">
                    <button class="scroll-button" onclick="scrollToSection('about')">
                        <i class="fas fa-chevron-down"></i>
                        <span>Kh√°m ph√° th√™m</span>
                    </button>
                </div>
                <!-- <div class="hero-stats">
                    <div class="stat-item">
                        <span class="stat-number">10K+</span>
                        <span class="stat-label">Ng∆∞·ªùi ch∆°i</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">4.8</span>
                        <span class="stat-label">ƒê√°nh gi√°</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">50+</span>
                        <span class="stat-label">Lo·∫°i hoa</span>
                    </div>
                </div> -->
            </div>
            <div class="hero-image">
                <div class="game-preview">
                    <div class="advanced-carousel">
                        <div class="carousel-wrapper">
                            <div class="carousel-track" id="carouselTrack">
                                <div class="carousel-item active" data-index="0">
                                    <img src="images/m·ª• th·∫£o.png" alt="M·ª• Th·∫£o" class="carousel-img">
                                    <div class="item-overlay">
                                        <h4>M·ª• Th·∫£o</h4>
                                        <p>Gi√† l√†ng</p>
                                    </div>
                                </div>
                                <div class="carousel-item" data-index="1">
                                    <img src="images/t√≠ n·ªã n·ªØ.png" alt="T√≠ N·ªã N·ªØ" class="carousel-img">
                                    <div class="item-overlay">
                                        <h4>T√≠ N·ªã N·ªØ</h4>
                                        <p>Nh√¢n v·∫≠t ch√≠nh</p>
                                    </div>
                                </div>
                                <div class="carousel-item" data-index="2">
                                    <img src="images/tinh linh.png" alt="Tinh Linh" class="carousel-img">
                                    <div class="item-overlay">
                                        <h4>Tinh Linh</h4>
                                        <p>Tinh linh c√¢y pha l√™</p>
                                    </div>
                                </div>
                                <div class="carousel-item" data-index="3">
                                    <img src="images/m·ª• x√°m.png" alt="M·ª• X√°m" class="carousel-img">
                                    <div class="item-overlay">
                                        <h4>M·ª• X√°m</h4>
                                        <p>Ph√π th·ªßy t√†i nƒÉng</p>
                                    </div>
                                </div>
                                <div class="carousel-item" data-index="4">
                                    <img src="img/z7056398979903_dffe5cadf073b176003b5973aaa62961.jpg" alt="Scylla Cambell" class="carousel-img">
                                    <div class="item-overlay">
                                        <h4>Scylla Cambell</h4>
                                        <p>Ch·ªß hi·ªáp h√¥i m·∫°o hi·ªÉm</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Navigation Controls -->
                        <div class="carousel-controls">
                            <button class="carousel-nav prev" id="prevBtn">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="carousel-nav next" id="nextBtn">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                        
                        <!-- Progress Bar -->
                        <div class="carousel-progress">
                            <div class="progress-bar" id="progressBar"></div>
                        </div>
                        
                        <!-- Dots Indicator -->
                        <div class="carousel-dots" id="carouselDots">
                            <span class="dot active" data-slide="0"></span>
                            <span class="dot" data-slide="1"></span>
                            <span class="dot" data-slide="2"></span>
                            <span class="dot" data-slide="3"></span>
                            <span class="dot" data-slide="4"></span>
                        </div>
                    </div>
                    
                    <!-- <div class="floating-elements">
                        <div class="floating-flower flower-1">üå∏</div>
                        <div class="floating-flower flower-2">üå∫</div>
                        <div class="floating-flower flower-3">üåª</div>
                        <div class="floating-flower flower-4">üå∑</div>
                    </div> -->
                </div>
            </div>
        </div>
    </section>

    <!-- Daily Check-in Section -->
    <section id="checkin" class="checkin-section">
        <div class="container">
            <div class="checkin-header" data-aos="fade-up">
                <span class="section-tag">Ph·∫ßn th∆∞·ªüng h√†ng ng√†y</span>
                <h2 class="section-title">ƒêi·ªÉm Danh Nh·∫≠n Kim C∆∞∆°ng</h2>
                <p class="section-subtitle">
                    ƒêi·ªÉm danh m·ªói ng√†y ƒë·ªÉ nh·∫≠n kim c∆∞∆°ng v√† c√°c ph·∫ßn th∆∞·ªüng h·∫•p d·∫´n!
                </p>
            </div>
            
            <div class="checkin-content">
                <!-- User Stats -->
                <div class="checkin-stats" data-aos="fade-up" data-aos-delay="100">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-gem"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="totalDiamonds">0</span>
                            <span class="stat-label">Kim c∆∞∆°ng</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="stat-info">
                            <span class="stat-value" id="totalCheckins">0</span>
                            <span class="stat-label">T·ªïng ƒëi·ªÉm danh</span>
                        </div>
                    </div>
                </div>

                <!-- Monthly Calendar -->
                <div class="checkin-calendar" data-aos="fade-up" data-aos-delay="200">
                    <div class="calendar-header">
                        <h3>
                            <i class="fas fa-calendar-alt"></i>
                            L·ªãch ƒêi·ªÉm Danh Th√°ng <span id="currentMonth"></span>
                        </h3>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar days will be generated by JavaScript -->
                    </div>
                </div>

                <!-- Check-in Button -->
                <div class="checkin-action" data-aos="fade-up" data-aos-delay="300">
                    <button class="checkin-btn" id="checkinBtn" onclick="handleCheckin()">
                        <i class="fas fa-hand-pointer"></i>
                        <span>ƒêi·ªÉm Danh H√¥m Nay</span>
                    </button>
                    <p class="checkin-hint" id="checkinHint">Nh·∫•n ƒë·ªÉ nh·∫≠n ph·∫ßn th∆∞·ªüng h√¥m nay!</p>
                </div>

             
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about">
        <div class="container">
            <div class="about-content">
                <div class="about-header">
                    <span class="section-tag">C√¢u chuy·ªán</span>
                    <h2 class="section-title">Kh√°m ph√° th·∫ø gi·ªõi L√†ng Hoa R·ª±c</h2>
                    <p class="section-subtitle">
                        M·ªôt h√†nh tr√¨nh ƒë·∫ßy m√†u s·∫Øc v·ªÅ s·ª± tha th·ª©, h·ªìi sinh v√† t√¨nh y√™u thi√™n nhi√™n
                    </p>
                </div>
                
                <div class="about-grid">
                    <div class="about-item" data-aos="fade-up" data-aos-delay="100">
                        <div class="about-icon">
                            <i class="fas fa-seedling"></i>
                        </div>
                        <h3>Gieo tr·ªìng hy v·ªçng</h3>
                        <p>C√πng T√≠ T·∫πo gieo nh·ªØng h·∫°t gi·ªëng hy v·ªçng, mang m√†u s·∫Øc tr·ªü l·∫°i cho th·∫ø gi·ªõi ƒë√£ m·∫•t ƒëi s·ª± r·ª±c r·ª°.</p>
                    </div>
                    
                    <div class="about-item" data-aos="fade-up" data-aos-delay="200">
                        <div class="about-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <h3>S·ª©c m·∫°nh t√¨nh y√™u</h3>
                        <p>Kh√°m ph√° c√¢u chuy·ªán c·∫£m ƒë·ªông v·ªÅ s·ª± tha th·ª© v√† t√¨nh y√™u c√≥ th·ªÉ ch·ªØa l√†nh m·ªçi v·∫øt th∆∞∆°ng.</p>
                    </div>
                    
                    <div class="about-item" data-aos="fade-up" data-aos-delay="300">
                        <div class="about-icon">
                            <i class="fas fa-magic"></i>
                        </div>
                        <h3>Ph√©p m√†u thi√™n nhi√™n</h3>
                        <p>Tr·∫£i nghi·ªám th·∫ø gi·ªõi th·∫ßn k·ª≥ n∆°i m·ªói c√¢y hoa ƒë·ªÅu mang trong m√¨nh m·ªôt c√¢u chuy·ªán ri√™ng.</p>
                    </div>
                </div>
                
                <div class="story-container">
                    <!-- Chapter Selector -->
                    <div class="chapter-selector" data-aos="fade-up">
                        <h3>üìñ C·ªët Truy·ªán "L√†ng Hoa R·ª±c"</h3>
                        <div class="chapter-tabs">
                            <button class="chapter-tab active" onclick="showChapter(1)">Ch∆∞∆°ng 1</button>
                            <button class="chapter-tab" onclick="showChapter(2)">Ch∆∞∆°ng 2</button>
                            <button class="chapter-tab" onclick="showChapter(3)">Ch∆∞∆°ng 3</button>
                            <button class="chapter-tab" onclick="showChapter(4)">Ch∆∞∆°ng 4</button>
                            <button class="chapter-tab" onclick="showChapter(5)">Ch∆∞∆°ng 5</button>
                            <button class="chapter-tab" onclick="showChapter(6)">Ch∆∞∆°ng 6</button>
                        </div>
                    </div>

                    <!-- Story Content -->
                    <div class="about-story">
                        <div class="story-text" data-aos="fade-right">
                            <!-- Chapter 1 -->
                            <div class="story-chapter active" id="chapter-1">
                                <h4>Ch∆∞∆°ng 1 ‚Äì H·∫°t M·∫ßm Hy V·ªçng</h4>
                                <p>
                                    M∆∞·ªùi nƒÉm sau khi C√¢y Pha L√™ v·ª° v·ª•n b·ªüi l·ªùi nguy·ªÅn c·ªßa M·ª• X√°m, <strong>T√≠ N·ªã</strong> ‚Äì c∆∞ d√¢n m·ªõi ‚Äì ƒë·∫øn l√†ng Hoa R·ª±c. 
                                    C·∫≠u tr·ªìng nh·ªØng b√¥ng hoa ƒë·∫ßu ti√™n, s·∫Øc m√†u d·∫ßn tr·ªü l·∫°i. <em>Tinh Linh N√¥ng Tr·∫°i</em> xu·∫•t hi·ªán ƒë·ªìng h√†nh c√πng c·∫≠u.
                                </p>
                            </div>

                            <!-- Chapter 2 -->
                            <div class="story-chapter" id="chapter-2">
                                <h4>Ch∆∞∆°ng 2 ‚Äì G·∫Øn K·∫øt Ni·ªÅm Tin</h4>
                                <p>
                                    T√≠ N·ªã gi√∫p d√¢n l√†ng l√†m vi·ªác, s·ª≠a c√¥ng c·ª•, l√†m b√°nh. Ni·ªÅm tin ƒë∆∞·ª£c x√¢y d·ª±ng l·∫°i, d√¢n l√†ng b·∫Øt ƒë·∫ßu m·ªü l√≤ng. 
                                    T√≠ N·ªã nh·∫≠n th√™m <span class="highlight-text">m·∫£nh pha l√™</span> v√† bi·∫øt r√µ h∆°n v·ªÅ truy·ªÅn thuy·∫øt C√¢y Pha L√™.
                                </p>
                            </div>

                            <!-- Chapter 3 -->
                            <div class="story-chapter" id="chapter-3">
                                <h4>Ch∆∞∆°ng 3 ‚Äì Gi√≥ H√°t Tr√™n C·ªëi Xay</h4>
                                <p>
                                    C·ªëi xay gi√≥ ƒë∆∞·ª£c d·ª±ng l·∫°i, l√∫a v√†ng tr·ªï b√¥ng, √¢m thanh lao ƒë·ªông tr√†n v·ªÅ. L√†ng d·∫ßn kh·ªüi s·∫Øc, 
                                    k√Ω ·ª©c v·ªÅ th·ªùi ho√†ng kim √πa v·ªÅ. T√≠ N·ªã nh·∫∑t ƒë∆∞·ª£c th√™m <span class="highlight-text">m·∫£nh pha l√™</span>.
                                </p>
                            </div>

                            <!-- Chapter 4 -->
                            <div class="story-chapter" id="chapter-4">
                                <h4>Ch∆∞∆°ng 4 ‚Äì S·∫Øc Hoa Tr·ªü L·∫°i</h4>
                                <p>
                                    Hoa r·ª±c r·ª° n·ªü kh·∫Øp n∆°i, <strong>L·ªÖ H·ªôi Hoa R·ª±c</strong> l·∫ßn ƒë·∫ßu ƒë∆∞·ª£c t·ªï ch·ª©c l·∫°i. Trong ni·ªÅm vui, 
                                    <em>M·ª• X√°m</em> tho√°ng xu·∫•t hi·ªán, ƒë·ªÉ l·∫°i s·ª± hoang mang v√† l·ªùi th√¨ th·∫ßm v·ªÅ qu√° kh·ª© b√† t·ª´ng l√† ngh·ªá nh√¢n hoa t√†i hoa.
                                </p>
                            </div>

                            <!-- Chapter 5 -->
                            <div class="story-chapter" id="chapter-5">
                                <h4>Ch∆∞∆°ng 5 ‚Äì L·ªùi Th√¨ Th·∫ßm X√°m</h4>
                                <p>
                                    T√≠ N·ªã d·∫ßn ph√°t hi·ªán ra n·ªói c√¥ ƒë∆°n v√† khao kh√°t ƒë∆∞·ª£c c√¥ng nh·∫≠n c·ªßa M·ª• X√°m. D√¢n l√†ng k·ªÉ r·∫±ng b√† t·ª´ng gi√∫p √≠ch, 
                                    nh∆∞ng b·ªã b√≥ng t·ªëi nu·ªët ch·ª≠ng. Khi thu th·∫≠p ƒë·ªß <span class="highlight-text">h·∫°t gi·ªëng k·ª≥ di·ªáu</span> v√† m·∫£nh pha l√™, 
                                    T√≠ N·ªã m·ªü ƒë∆∞·ªùng ƒë·∫øn ƒê·ªìi Pha L√™.
                                </p>
                            </div>

                            <!-- Chapter 6 -->
                            <div class="story-chapter" id="chapter-6">
                                <h4>Ch∆∞∆°ng 6 ‚Äì C√¢y Pha L√™</h4>
                                <p>
                                    T√≠ N·ªã c√πng d√¢n l√†ng tr·ªìng l·∫°i <strong>C√¢y Pha L√™</strong>. M·ª• X√°m xu·∫•t hi·ªán ƒë·ªãnh ngƒÉn c·∫£n, 
                                    nh∆∞ng thay v√¨ chi·∫øn ƒë·∫•u, d√¢n l√†ng trao cho b√† v√≤ng hoa t·ª´ t·∫•m l√≤ng m·ªçi ng∆∞·ªùi. 
                                    N∆∞·ªõc m·∫Øt b√† r∆°i xu·ªëng, l·ªùi nguy·ªÅn tan bi·∫øn, C√¢y Pha L√™ b·ª´ng s√°ng, s·∫Øc m√†u lan t·ªèa kh·∫Øp l√†ng.
                                </p>
                                <p class="story-ending">
                                    <em>M·ª• X√°m kh√¥ng bi·∫øn m·∫•t, v·∫´n s·ªëng l·∫∑ng l·∫Ω ngo√†i r√¨a, th·ªânh tho·∫£ng mang ƒë·∫øn gi·ªëng hoa hi·∫øm ‚Äì 
                                    nh∆∞ m·ªôt c√°ch chu·ªôc l·ªói th·∫ßm l·∫∑ng.</em>
                                </p>
                            </div>

                            <!-- Chapter Navigation -->
                            <div class="chapter-nav">
                                <button class="nav-button" id="prevBtn" onclick="previousChapter()">
                                    <i class="fas fa-chevron-left"></i>
                                    Ch∆∞∆°ng tr∆∞·ªõc
                                </button>
                                <button class="nav-button" id="nextBtn" onclick="nextChapter()">
                                    Ch∆∞∆°ng ti·∫øp
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>

                            <div class="story-features">
                                <div class="feature">
                                    <span class="feature-number">6</span>
                                    <span class="feature-text">Ch∆∞∆°ng h·∫•p d·∫´n</span>
                                </div>
                                <div class="feature">
                                    <span class="feature-number">5</span>
                                    <span class="feature-text">Nh√¢n v·∫≠t ch√≠nh</span>
                                </div>
                                <div class="feature">
                                    <span class="feature-number">10+</span>
                                    <span class="feature-text">Gi·ªù gameplay</span>
                                </div>
                            </div>

                          
                        </div>
                    <div class="story-image">
                        <img src="img/muxam.png" alt="T√≠ T·∫πo - Nh√¢n v·∫≠t ch√≠nh">
                        <!-- <div class="story-decoration">
                            <div class="deco-flower deco-1">üå∏</div>
                            <div class="deco-flower deco-2">üå∫</div>
                            <div class="deco-flower deco-3">üåª</div>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer" id="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-main">
                    <div class="footer-brand">
                        <div class="footer-logo">
                            <img src="img/logo/ChatGPT Image 13_27_39 3 thg 9, 2025.png" alt="L√†ng Hoa R·ª±c Logo" class="logo-img">
                            <div class="logo-text">
                                <h3>L√†ng Hoa R·ª±c</h3>
                                <p>Game N√¥ng Tr·∫°i Th·∫ßn K·ª≥</p>
                            </div>
                        </div>
                        <div class="footer-description">
                            <p>Kh√°m ph√° th·∫ø gi·ªõi ƒë·∫ßy m√†u s·∫Øc v√† ph√©p thu·∫≠t, n∆°i t√¨nh y√™u v√† s·ª± tha th·ª© c√≥ th·ªÉ ch·ªØa l√†nh m·ªçi v·∫øt th∆∞∆°ng.</p>
                        </div>
                    </div>
                    
                   
                
                <div class="footer-bottom">
                    <div class="footer-links">
                        <a href="#hero">
                            <i class="fas fa-home"></i>
                            Trang ch·ªß
                        </a>
                        <a href="#about">
                            <i class="fas fa-info-circle"></i>
                            Gi·ªõi thi·ªáu
                        </a>
                        <a href="#" onclick="openLoginModal()">
                            <i class="fas fa-sign-in-alt"></i>
                            ƒêƒÉng nh·∫≠p
                        </a>
                        <a href="#" onclick="downloadGame()">
                            <i class="fas fa-download"></i>
                            T·∫£i game
                        </a>
                    </div>
                    <div class="footer-divider"></div>
                    
                    <!-- Team Section -->
                    <div class="footer-team-section">
                        <h4>Nh√≥m Ph√°t Tri·ªÉn</h4>
                        <div class="team-badge-wrapper">
                            <span class="team-badge">Nh√≥m 6</span>
                        </div>
                        <div class="team-members-horizontal">
                            <div class="member-item">Nguy·ªÖn Ti·∫øn Ch·ª©c</div>
                            <div class="member-item">Tr·∫ßn Nguy·ªÖn Ki·ªÅu Duy√™n</div>
                            <div class="member-item">V√µ Tr·∫ßn Ho√†ng B·∫£o Khang</div>
                            <div class="member-item">Ph·∫°m H·ªìng Qu√¢n</div>
                            <div class="member-item">ƒê·ªó Nh·∫≠t H√†o</div>
                        </div>
                    </div>
                    
                    <div class="footer-copyright">
                        <p>&copy; 2025 L√†ng Hoa R·ª±c - Nh√≥m 6. T·∫•t c·∫£ quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.</p>
                       
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Video Trailer Modal -->
    <div id="videoModal" class="video-modal">
        <div class="video-modal-overlay" onclick="closeVideoModal()"></div>
        <div class="video-modal-content">
            <button class="video-close-btn" onclick="closeVideoModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="video-container">
                <video id="trailerVideo" controls preload="metadata">
                    <source src="video/0911.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <div class="video-info">
                <h3>Game Trailer - V∆∞·ªùn R·ª±c R·ª°</h3>
                <p>Kh√°m ph√° th·∫ø gi·ªõi th·∫ßn k·ª≥ ƒë·∫ßy m√†u s·∫Øc v√† ph√©p thu·∫≠t</p>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="login-modal">
        <div class="login-modal-overlay" onclick="closeLoginModal()"></div>
        <div class="login-modal-content">
            <button class="login-close-btn" onclick="closeLoginModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="login-container">
                <div class="login-header">
                    <img src="img/logo/ChatGPT Image 13_27_39 3 thg 9, 2025.png" alt="Logo" class="login-logo">
                    <h2>ƒêƒÉng nh·∫≠p</h2>
                    <p>Ch√†o m·ª´ng tr·ªü l·∫°i v·ªõi L√†ng Hoa R·ª±c!</p>
                </div>
                <form class="login-form" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label for="username">Email:</label>
                        <input type="email" id="username" name="username" required placeholder="example@email.com">
                        <i class="fas fa-envelope input-icon"></i>
                    </div>
                    <div class="form-group">
                        <label for="password">M·∫≠t kh·∫©u:</label>
                        <input type="password" id="password" name="password" required>
                        <i class="fas fa-eye password-toggle" onclick="togglePassword()"></i>
                    </div>
                    <div class="form-options">
                        <label class="checkbox-label">
                            <input type="checkbox" id="remember">
                            <span class="checkmark"></span>
                            Ghi nh·ªõ ƒëƒÉng nh·∫≠p
                        </label>
                        <a href="#" class="forgot-password" onclick="openForgotPasswordModal()">Qu√™n m·∫≠t kh·∫©u?</a>
                    </div>
                    <button type="submit" class="login-submit-btn">
                        <i class="fas fa-sign-in-alt"></i>
                        ƒêƒÉng nh·∫≠p
                    </button>
                </form>
                <div class="login-divider">
                    <span>ho·∫∑c</span>
                </div>
                <div class="social-login">
                    <button class="social-btn google-btn" onclick="loginWithGoogle()">
                        <i class="fab fa-google"></i>
                        ƒêƒÉng nh·∫≠p v·ªõi Google
                    </button>
                </div>
                <div class="login-footer">
                    <p>Ch∆∞a c√≥ t√†i kho·∫£n? <a href="#" onclick="openRegisterModal()">ƒêƒÉng k√Ω ngay</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="login-modal">
        <div class="login-modal-overlay" onclick="closeRegisterModal()"></div>
        <div class="login-modal-content">
            <button class="login-close-btn" onclick="closeRegisterModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="login-container">
                <div class="login-header">
                    <img src="img/logo/ChatGPT Image 13_27_39 3 thg 9, 2025.png" alt="Logo" class="login-logo">
                    <h2>ƒêƒÉng k√Ω t√†i kho·∫£n</h2>
                    <p>T·∫°o t√†i kho·∫£n ƒë·ªÉ kh√°m ph√° L√†ng Hoa R·ª±c!</p>
                </div>
                <form class="login-form" onsubmit="handleRegister(event)">
                    <div class="form-group">
                        <label for="reg-fullname">H·ªç v√† t√™n:</label>
                        <input type="text" id="reg-fullname" name="fullname" required>
                        <i class="fas fa-user input-icon"></i>
                    </div>
                    <div class="form-group">
                        <label for="reg-email">Email:</label>
                        <input type="email" id="reg-email" name="email" required>
                        <i class="fas fa-envelope input-icon"></i>
                    </div>
                    <div class="form-group">
                        <label for="reg-username">T√™n ƒëƒÉng nh·∫≠p:</label>
                        <input type="text" id="reg-username" name="username" required>
                        <i class="fas fa-user-circle input-icon"></i>
                    </div>
                    <div class="form-group">
                        <label for="reg-password">M·∫≠t kh·∫©u:</label>
                        <input type="password" id="reg-password" name="password" required>
                        <i class="fas fa-eye password-toggle" onclick="toggleRegisterPassword()"></i>
                    </div>
                    <div class="form-group">
                        <label for="reg-confirm-password">X√°c nh·∫≠n m·∫≠t kh·∫©u:</label>
                        <input type="password" id="reg-confirm-password" name="confirmPassword" required>
                        <i class="fas fa-eye password-toggle" onclick="toggleConfirmPassword()"></i>
                    </div>
                    <div class="form-options">
                        <label class="checkbox-label">
                            <input type="checkbox" id="agree-terms" required>
                            <span class="checkmark"></span>
                            T√¥i ƒë·ªìng √Ω v·ªõi <a href="#" onclick="openTermsModal()">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a>
                        </label>
                    </div>
                    <button type="submit" class="login-submit-btn">
                        <i class="fas fa-user-plus"></i>
                        T·∫°o t√†i kho·∫£n
                    </button>
                </form>
                <div class="login-divider">
                    <span>ho·∫∑c</span>
                </div>
                <div class="social-login">
                    <button class="social-btn google-btn" onclick="registerWithGoogle()">
                        <i class="fab fa-google"></i>
                        ƒêƒÉng k√Ω v·ªõi Google
                    </button>
                </div>
                <div class="login-footer">
                    <p>ƒê√£ c√≥ t√†i kho·∫£n? <a href="#" onclick="openLoginFromRegister()">ƒêƒÉng nh·∫≠p ngay</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
    <div id="forgotPasswordModal" class="login-modal">
        <div class="login-modal-overlay" onclick="closeForgotPasswordModal()"></div>
        <div class="login-modal-content">
            <button class="login-close-btn" onclick="closeForgotPasswordModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="login-container">
                <div class="login-header">
                    <img src="img/logo/ChatGPT Image 13_27_39 3 thg 9, 2025.png" alt="Logo" class="login-logo">
                    <h2>Qu√™n m·∫≠t kh·∫©u</h2>
                    <p>Nh·∫≠p email ƒë·ªÉ kh√¥i ph·ª•c m·∫≠t kh·∫©u c·ªßa b·∫°n</p>
                </div>
                <form class="login-form" onsubmit="handleForgotPassword(event)">
                    <div class="form-group">
                        <label for="forgot-email">Email c·ªßa b·∫°n:</label>
                        <input type="email" id="forgot-email" name="email" required placeholder="example@email.com">
                        <i class="fas fa-envelope input-icon"></i>
                    </div>
                    <button type="submit" class="login-submit-btn">
                        <i class="fas fa-paper-plane"></i>
                        G·ª≠i link kh√¥i ph·ª•c
                    </button>
                </form>
                <div class="login-footer" style="border-top: none; padding-top: 15px;">
                    <p>Nh·ªõ l·∫°i m·∫≠t kh·∫©u? <a href="#" onclick="openLoginFromForgot()">ƒêƒÉng nh·∫≠p</a></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Password Reset Success Modal -->
    <div id="resetSuccessModal" class="login-modal">
        <div class="login-modal-overlay" onclick="closeResetSuccessModal()"></div>
        <div class="login-modal-content">
            <button class="login-close-btn" onclick="closeResetSuccessModal()">
                <i class="fas fa-times"></i>
            </button>
            <div class="login-container">
                <div class="login-header">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2>Email ƒë√£ ƒë∆∞·ª£c g·ª≠i!</h2>
                    <p>Vui l√≤ng ki·ªÉm tra email c·ªßa b·∫°n ƒë·ªÉ nh·∫≠n link kh√¥i ph·ª•c m·∫≠t kh·∫©u</p>
                </div>
                <div class="success-content">
                    <div class="info-box">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>L∆∞u √Ω:</strong>
                            <ul>
                                <li>Ki·ªÉm tra c·∫£ th∆∞ m·ª•c spam/junk</li>
                                <li>Link s·∫Ω h·∫øt h·∫°n sau 1 gi·ªù</li>
                                <li>N·∫øu kh√¥ng nh·∫≠n ƒë∆∞·ª£c email, th·ª≠ l·∫°i sau 5 ph√∫t</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="login-footer" style="border-top: none;">
                    <button class="login-submit-btn" onclick="closeResetSuccessModal()">
                        <i class="fas fa-arrow-left"></i>
                        Quay l·∫°i ƒëƒÉng nh·∫≠p
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.1/dist/sweetalert2.all.min.js"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        // Import Firebase SDK from CDN
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';
        import { 
            getAuth, 
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut,
            sendPasswordResetEmail,
            GoogleAuthProvider,
            signInWithPopup,
            updateProfile,
            onAuthStateChanged
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { 
            getFirestore, 
            doc, 
            setDoc, 
            getDoc,
            collection,
            query,
            where,
            getDocs
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import { 
            getDatabase, 
            ref, 
            set, 
            get,
            update,
            child
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDA2nXjMUZu7IcTmQIg3uNgJdb8PBWy618",
            authDomain: "trangtrai-2769b.firebaseapp.com",
            databaseURL: "https://trangtrai-2769b-default-rtdb.firebaseio.com",
            projectId: "trangtrai-2769b",
            storageBucket: "trangtrai-2769b.firebasestorage.app",
            messagingSenderId: "455581137012",
            appId: "1:455581137012:web:4f3c2a5c8fe7d1a4b3b921",
            measurementId: "G-3RWSR0ZC1G"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const rtdb = getDatabase(app);

        // Make Firebase available globally
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseRTDB = rtdb;
        
        // Listen for auth state changes to update check-in UI
        onAuthStateChanged(auth, (user) => {
            console.log('Auth state changed:', user ? 'Logged in' : 'Logged out');
            
            // Update check-in UI when auth changes
            if (document.getElementById('checkinBtn')) {
                // Use setTimeout to ensure functions are loaded
                setTimeout(() => {
                    if (window.updateCheckinButton) {
                        window.updateCheckinButton();
                    }
                    if (window.updateStatsDisplay) {
                        window.updateStatsDisplay();
                    }
                    if (window.initializeCalendar) {
                        window.initializeCalendar();
                    }
                }, 100);
            }
        });
        
        console.log('üî• Firebase initialized successfully!');
    </script>
    <script type="module" src="js/firebase-auth.js"></script>
    
    <!-- Scripts -->
    <script src="js/landing-script.js"></script>
    
    <!-- Debug Script for Carousel -->
    <script>
        // Ki·ªÉm tra carousel sau khi page load
        window.addEventListener('load', () => {
            // Force hide carousel on mobile
            function hideCarouselOnMobile() {
                if (window.innerWidth <= 768) {
                    const heroImage = document.querySelector('.hero-image');
                    const gamePreview = document.querySelector('.game-preview');
                    const carousel = document.querySelector('.advanced-carousel');
                    
                    if (heroImage) {
                        heroImage.style.display = 'none';
                        heroImage.style.visibility = 'hidden';
                        heroImage.style.opacity = '0';
                        heroImage.style.position = 'absolute';
                        heroImage.style.left = '-9999px';
                        heroImage.style.top = '-9999px';
                        heroImage.style.width = '0';
                        heroImage.style.height = '0';
                        heroImage.style.overflow = 'hidden';
                        heroImage.style.zIndex = '-9999';
                    }
                    
                    if (gamePreview) {
                        gamePreview.style.display = 'none';
                        gamePreview.style.visibility = 'hidden';
                    }
                    
                    if (carousel) {
                        carousel.style.display = 'none';
                        carousel.style.visibility = 'hidden';
                    }
                    
                    console.log('üö´ Carousel hidden on mobile!');
                } else {
                    console.log('üíª Desktop - Carousel visible');
                }
            }
            
            // Hide immediately
            hideCarouselOnMobile();
            
            // Hide on resize
            window.addEventListener('resize', hideCarouselOnMobile);
            
            setTimeout(() => {
                console.log('üîç Ki·ªÉm tra carousel status...');
                const carouselItems = document.querySelectorAll('.carousel-item');
                const dots = document.querySelectorAll('.dot');
                
                console.log('Carousel items found:', carouselItems.length);
                console.log('Dots found:', dots.length);
                console.log('Carousel instance:', window.advancedHeroCarousel);
                
                if (window.advancedHeroCarousel) {
                    console.log('‚úÖ Carousel ho·∫°t ƒë·ªông:', window.advancedHeroCarousel.isAutoPlaying);
                } else {
                    console.warn('‚ùå Carousel ch∆∞a ƒë∆∞·ª£c kh·ªüi t·∫°o!');
                }
            }, 2000);
        });
        
        // Manual controls for debugging
        function debugCarousel() {
            if (window.advancedHeroCarousel) {
                console.log('Current index:', window.advancedHeroCarousel.currentIndex);
                console.log('Total items:', window.advancedHeroCarousel.totalItems);
                console.log('AutoPlay status:', window.advancedHeroCarousel.isAutoPlaying);
                window.advancedHeroCarousel.nextSlide();
            }
        }
        
        // Timeline functions removed - no longer needed
        
        // SweetAlert2 Helper Functions
        function showSuccessAlert(title, text, callback) {
            Swal.fire({
                icon: 'success',
                title: title,
                text: text,
                confirmButtonText: 'Tuy·ªát v·ªùi!',
                confirmButtonColor: '#4a90e2',
                background: '#ffffff',
                color: '#333333',
                showConfirmButton: true,
                timer: 3000,
                timerProgressBar: true,
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button'
                }
            }).then((result) => {
                if (callback) callback(result);
            });
        }
        
        function showErrorAlert(title, text, callback) {
            Swal.fire({
                icon: 'error',
                title: title,
                text: text,
                confirmButtonText: 'Th·ª≠ l·∫°i',
                confirmButtonColor: '#ff6b6b',
                background: '#ffffff',
                color: '#333333',
                showConfirmButton: true,
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button-error'
                }
            }).then((result) => {
                if (callback) callback(result);
            });
        }
        
        function showWarningAlert(title, text, callback) {
            Swal.fire({
                icon: 'warning',
                title: title,
                text: text,
                confirmButtonText: 'ƒê√£ hi·ªÉu',
                confirmButtonColor: '#ffa726',
                background: '#ffffff',
                color: '#333333',
                showConfirmButton: true,
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button-warning'
                }
            }).then((result) => {
                if (callback) callback(result);
            });
        }
        
        function showInfoAlert(title, text, callback) {
            Swal.fire({
                icon: 'info',
                title: title,
                text: text,
                confirmButtonText: 'OK',
                confirmButtonColor: '#4a90e2',
                background: '#ffffff',
                color: '#333333',
                showConfirmButton: true,
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button'
                }
            }).then((result) => {
                if (callback) callback(result);
            });
        }
        
        function showConfirmAlert(title, text, confirmCallback, cancelCallback) {
            Swal.fire({
                icon: 'question',
                title: title,
                text: text,
                showCancelButton: true,
                confirmButtonText: 'ƒê·ªìng √Ω',
                cancelButtonText: 'H·ªßy b·ªè',
                confirmButtonColor: '#4a90e2',
                cancelButtonColor: '#6c757d',
                background: '#ffffff',
                color: '#333333',
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button',
                    cancelButton: 'custom-swal-button-cancel'
                }
            }).then((result) => {
                if (result.isConfirmed && confirmCallback) {
                    confirmCallback(result);
                } else if (result.isDismissed && cancelCallback) {
                    cancelCallback(result);
                }
            });
        }
        
        function showLoadingAlert(title, text) {
            Swal.fire({
                title: title,
                text: text,
                allowOutsideClick: false,
                allowEscapeKey: false,
                showConfirmButton: false,
                background: '#ffffff',
                color: '#333333',
                didOpen: () => {
                    Swal.showLoading();
                },
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title'
                }
            });
        }
        
        function closeLoadingAlert() {
            Swal.close();
        }
        
        // Download Game Function
        function downloadGame() {
            // Show loading alert
            showLoadingAlert('ƒêang chu·∫©n b·ªã t·∫£i xu·ªëng...', 'Vui l√≤ng ch·ªù trong gi√¢y l√°t...');
            
            // Simulate preparation time (2 seconds)
            setTimeout(() => {
                closeLoadingAlert();
                
                // Show download confirmation with file info
                Swal.fire({
                    icon: 'info',
                    title: 'T·∫£i xu·ªëng L√†ng Hoa R·ª±c (Launcher)',
                    html: `
                        <div style="text-align: left; margin: 20px 0;">
                            <p><strong>T√™n file:</strong> LangHoaRucLauncher.exe</p>
                            <p><strong>K√≠ch th∆∞·ªõc:</strong> ~84.6 MB</p>
                            <p><strong>Phi√™n b·∫£n:</strong> v1.0.0 (Launcher)</p>
                            <p><strong>Ngu·ªìn:</strong> M√°y ch·ªß ch√≠nh th·ª©c</p>
                            <p><strong>H·ªó tr·ª£:</strong> Windows 10 / Windows 11</p>
                            <div style="margin-top: 15px;">
                                <strong>Y√™u c·∫ßu t·ªëi thi·ªÉu:</strong>
                                <ul style="margin: 8px 0; padding-left: 20px;">
                                    <li>RAM: 4GB+</li>
                                    <li>CPU: Intel/AMD 64-bit</li>
                                    <li>·ªî ƒëƒ©a tr·ªëng: 500MB+</li>
                                    <li>Quy·ªÅn ch·∫°y file .exe</li>
                                </ul>
                            </div>
                        </div>
                       
                    `,
                    showCancelButton: true,
                    confirmButtonText: '<i class="fas fa-download"></i> T·∫£i ngay',
                    cancelButtonText: 'H·ªßy',
                    confirmButtonColor: '#4a90e2',
                    cancelButtonColor: '#6c757d',
                    customClass: {
                        popup: 'custom-swal-popup',
                        title: 'custom-swal-title',
                        confirmButton: 'custom-swal-button',
                        cancelButton: 'custom-swal-button-cancel'
                    }
                }).then((result) => {
                    if (result.isConfirmed) {
                        // Start actual download
                        startDownload();
                    }
                });
            }, 2000);
        }
        
        function startDownload() {
            try {
                const exeFile = 'LangHoaRucLauncher.exe';
                const link = document.createElement('a');
                link.href = exeFile;
                link.download = 'LangHoaRucLauncher.exe';
                link.rel = 'noopener';
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                // Th√¥ng b√°o
                showSuccessAlert(
                    'ƒêang t·∫£i xu·ªëng...', 
                    'File LangHoaRucLauncher.exe ƒëang ƒë∆∞·ª£c t·∫£i v·ªÅ. N·∫øu tr√¨nh duy·ªát ch·∫∑n, h√£y ki·ªÉm tra thanh th√¥ng b√°o ho·∫∑c b·∫≠t cho ph√©p t·∫£i xu·ªëng.',
                    () => {
                        showInstallationGuide();
                    }
                );

                // G·ª≠i s·ª± ki·ªán Analytics n·∫øu c√≥
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'download_launcher', {
                        event_category: 'Launcher',
                        event_label: 'LangHoaRucLauncher.exe',
                        value: 1
                    });
                }
            } catch (error) {
                console.error('Download error:', error);
                showErrorAlert(
                    'L·ªói t·∫£i xu·ªëng!', 
                    'Kh√¥ng th·ªÉ t·∫£i file. Vui l√≤ng th·ª≠ l·∫°i sau ho·∫∑c li√™n h·ªá h·ªó tr·ª£.'
                );
            }
        }
        
        function showInstallationGuide() {
            Swal.fire({
                icon: 'info',
                title: 'H∆∞·ªõng d·∫´n c√†i ƒë·∫∑t',
                html: `
                    <div style="text-align: left; margin: 20px 0;">
                        <h4>C√°c b∆∞·ªõc ch·∫°y launcher:</h4>
                        <ol style="margin: 15px 0; padding-left: 20px;">
                            <li>T√¨m file <strong>LangHoaRucLauncher.exe</strong> trong th∆∞ m·ª•c Downloads</li>
                            <li>Nh·∫•p ƒë√¥i ho·∫∑c Chu·ªôt ph·∫£i > Run as administrator (n·∫øu c·∫ßn)</li>
                            <li>N·∫øu Windows c·∫£nh b√°o SmartScreen: Ch·ªçn More info > Run anyway</li>
                            <li>Launcher s·∫Ω ki·ªÉm tra v√† t·∫£i c√°c t√†i nguy√™n c·∫ßn thi·∫øt (n·∫øu c√≥)</li>
                            <li>Sau khi ho√†n t·∫•t, nh·∫•n Play ƒë·ªÉ v√†o game</li>
                        </ol>
                        
                        <h4>Y√™u c·∫ßu h·ªá th·ªëng:</h4>
                        <ul style="margin: 15px 0; padding-left: 20px;">
                            <li><strong>RAM:</strong> 4GB (Khuy·∫øn ngh·ªã 8GB)</li>
                            <li><strong>CPU:</strong> Intel i3 th·∫ø h·ªá 6+ ho·∫∑c t∆∞∆°ng ƒë∆∞∆°ng</li>
                            <li><strong>GPU:</strong> H·ªó tr·ª£ DirectX 11</li>
                            <li><strong>DirectX:</strong> 11+</li>
                            <li><strong>Dung l∆∞·ª£ng tr·ªëng:</strong> 1GB+</li>
                        </ul>
                        <div style="background:#eef7ff; padding:12px; border-radius:6px; border:1px solid #c3e2ff;">
                            <small><i class="fas fa-info-circle"></i> N·∫øu file kh√¥ng m·ªü: Chu·ªôt ph·∫£i > Properties > Unblock (n·∫øu c√≥) > Apply.</small>
                        </div>
                    </div>
                `,
                confirmButtonText: 'ƒê√£ hi·ªÉu',
                confirmButtonColor: '#4a90e2',
                customClass: {
                    popup: 'custom-swal-popup',
                    title: 'custom-swal-title',
                    confirmButton: 'custom-swal-button'
                }
            });
        }
        
        // Login Modal Functions
        function openLoginModal() {
            const modal = document.getElementById('loginModal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
            // Focus on username field
            setTimeout(() => {
                document.getElementById('username').focus();
            }, 100);
        }
        
        function closeLoginModal() {
            const modal = document.getElementById('loginModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            // Reset form
            document.querySelector('.login-form').reset();
        }
        
        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const toggleIcon = passwordInput.parentElement.querySelector('.password-toggle');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
            }
        }
        
        async function handleLogin(event) {
            event.preventDefault();
            const email = document.getElementById('username').value; // Changed to email
            const password = document.getElementById('password').value;
            const remember = document.getElementById('remember').checked;
            const submitBtn = event.target.querySelector('.login-submit-btn');
            
            // Basic validation
            if (!email || !password) {
                showError('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!', 'loginModal');
                return;
            }
            
            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showError('Vui l√≤ng nh·∫≠p email h·ª£p l·ªá!', 'loginModal');
                return;
            }
            
            showLoading(submitBtn);
            
            try {
                const result = await window.firebaseAuth.login(email, password);
                
                if (result.success) {
                    showSuccessAlert('ƒêƒÉng nh·∫≠p th√†nh c√¥ng!', 'Ch√†o m·ª´ng b·∫°n quay tr·ªü l·∫°i v·ªõi V∆∞·ªùn R·ª±c R·ª°!', () => {
                        closeLoginModal();
                    });
                } else {
                    showErrorAlert('ƒêƒÉng nh·∫≠p th·∫•t b·∫°i!', result.message);
                }
            } catch (error) {
                showErrorAlert('L·ªói h·ªá th·ªëng!', 'ƒê√£ c√≥ l·ªói x·∫£y ra! Vui l√≤ng th·ª≠ l·∫°i sau.');
                console.error('Login error:', error);
            } finally {
                hideLoading(submitBtn);
            }
        }
        
        async function loginWithGoogle() {
            try {
                const result = await window.firebaseAuth.loginWithGoogle();
                
                if (result.success) {
                    showSuccessAlert('ƒêƒÉng nh·∫≠p Google th√†nh c√¥ng!', 
                        'Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi V∆∞·ªùn R·ª±c R·ª°!', 
                        () => {
                            closeLoginModal();
                        });
                } else {
                    showErrorAlert('ƒêƒÉng nh·∫≠p Google th·∫•t b·∫°i!', result.message);
                }
            } catch (error) {
                showErrorAlert('L·ªói Google Authentication!', 'ƒê√£ c√≥ l·ªói x·∫£y ra khi ƒëƒÉng nh·∫≠p v·ªõi Google! Vui l√≤ng th·ª≠ l·∫°i.');
                console.error('Google login error:', error);
            }
        }
        
        // Register Modal Functions
        function openRegisterModal() {
            closeLoginModal();
            const modal = document.getElementById('registerModal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
            setTimeout(() => {
                document.getElementById('reg-fullname').focus();
            }, 100);
        }
        
        function closeRegisterModal() {
            const modal = document.getElementById('registerModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            document.querySelector('#registerModal .login-form').reset();
        }
        
        function openLoginFromRegister() {
            closeRegisterModal();
            openLoginModal();
        }
        
        function toggleRegisterPassword() {
            const passwordInput = document.getElementById('reg-password');
            const toggleIcon = passwordInput.parentElement.querySelector('.password-toggle');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
            }
        }
        
        function toggleConfirmPassword() {
            const passwordInput = document.getElementById('reg-confirm-password');
            const toggleIcon = passwordInput.parentElement.querySelector('.password-toggle');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.classList.remove('fa-eye');
                toggleIcon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                toggleIcon.classList.remove('fa-eye-slash');
                toggleIcon.classList.add('fa-eye');
            }
        }
        
        async function handleRegister(event) {
            event.preventDefault();
            const fullname = document.getElementById('reg-fullname').value;
            const email = document.getElementById('reg-email').value;
            const username = document.getElementById('reg-username').value;
            const password = document.getElementById('reg-password').value;
            const confirmPassword = document.getElementById('reg-confirm-password').value;
            const agreeTerms = document.getElementById('agree-terms').checked;
            const submitBtn = event.target.querySelector('.login-submit-btn');
            
            // Validation
            if (!fullname || !email || !username || !password || !confirmPassword) {
                showWarningAlert('Th√¥ng tin ch∆∞a ƒë·∫ßy ƒë·ªß!', 'Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß t·∫•t c·∫£ c√°c tr∆∞·ªùng th√¥ng tin.');
                return;
            }
            
            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showWarningAlert('Email kh√¥ng h·ª£p l·ªá!', 'Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ email ƒë√∫ng ƒë·ªãnh d·∫°ng.');
                return;
            }
            
            // Username validation
            if (username.length < 3) {
                showWarningAlert('T√™n ƒëƒÉng nh·∫≠p qu√° ng·∫Øn!', 'T√™n ƒëƒÉng nh·∫≠p ph·∫£i c√≥ √≠t nh·∫•t 3 k√Ω t·ª±.');
                return;
            }
            
            // Password validation
            if (password.length < 6) {
                showWarningAlert('M·∫≠t kh·∫©u qu√° y·∫øu!', 'M·∫≠t kh·∫©u ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª± ƒë·ªÉ ƒë·∫£m b·∫£o b·∫£o m·∫≠t.');
                return;
            }
            
            if (password !== confirmPassword) {
                showWarningAlert('M·∫≠t kh·∫©u kh√¥ng kh·ªõp!', 'Vui l√≤ng ki·ªÉm tra v√† nh·∫≠p l·∫°i m·∫≠t kh·∫©u cho ch√≠nh x√°c.');
                return;
            }
            
            if (!agreeTerms) {
                showWarningAlert('Ch∆∞a ƒë·ªìng √Ω ƒëi·ªÅu kho·∫£n!', 'B·∫°n c·∫ßn ƒë·ªìng √Ω v·ªõi ƒëi·ªÅu kho·∫£n s·ª≠ d·ª•ng ƒë·ªÉ ti·∫øp t·ª•c ƒëƒÉng k√Ω.');
                return;
            }
            
            showLoading(submitBtn);
            
            try {
                const result = await window.firebaseAuth.register(email, password, fullname, username);
                
                if (result.success) {
                    showSuccessAlert('ƒêƒÉng k√Ω th√†nh c√¥ng!', 
                        `Ch√†o m·ª´ng ${fullname} ƒë·∫øn v·ªõi V∆∞·ªùn R·ª±c R·ª°! H√£y b·∫Øt ƒë·∫ßu kh√°m ph√° th·∫ø gi·ªõi th·∫ßn k·ª≥ c·ªßa ch√∫ng ta.`, 
                        () => {
                            closeRegisterModal();
                        });
                } else {
                    showErrorAlert('ƒêƒÉng k√Ω th·∫•t b·∫°i!', result.message);
                }
            } catch (error) {
                showErrorAlert('L·ªói h·ªá th·ªëng!', 'ƒê√£ c√≥ l·ªói x·∫£y ra trong qu√° tr√¨nh ƒëƒÉng k√Ω! Vui l√≤ng th·ª≠ l·∫°i sau.');
                console.error('Register error:', error);
            } finally {
                hideLoading(submitBtn);
            }
        }
        
        async function registerWithGoogle() {
            try {
                const result = await window.firebaseAuth.loginWithGoogle();
                
                if (result.success) {
                    showSuccessAlert('ƒêƒÉng k√Ω Google th√†nh c√¥ng!', 
                        'T√†i kho·∫£n c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng! Ch√†o m·ª´ng ƒë·∫øn v·ªõi V∆∞·ªùn R·ª±c R·ª°!', 
                        () => {
                            closeRegisterModal();
                        });
                } else {
                    showErrorAlert('ƒêƒÉng k√Ω Google th·∫•t b·∫°i!', result.message);
                }
            } catch (error) {
                showErrorAlert('L·ªói Google Authentication!', 'ƒê√£ c√≥ l·ªói x·∫£y ra khi ƒëƒÉng k√Ω v·ªõi Google! Vui l√≤ng th·ª≠ l·∫°i.');
                console.error('Google register error:', error);
            }
        }
        
        function openTermsModal() {
            showInfoAlert('ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng', 
                'B·∫±ng vi·ªác s·ª≠ d·ª•ng V∆∞·ªùn R·ª±c R·ª°, b·∫°n ƒë·ªìng √Ω tu√¢n th·ªß c√°c quy ƒë·ªãnh v·ªÅ b·∫£o m·∫≠t th√¥ng tin v√† s·ª≠ d·ª•ng d·ªãch v·ª• m·ªôt c√°ch c√≥ tr√°ch nhi·ªám. Chi ti·∫øt ƒë·∫ßy ƒë·ªß s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t s·ªõm.');
        }
        
        // Forgot Password Modal Functions
        function openForgotPasswordModal() {
            closeLoginModal();
            const modal = document.getElementById('forgotPasswordModal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
            setTimeout(() => {
                document.getElementById('forgot-email').focus();
            }, 100);
        }
        
        function closeForgotPasswordModal() {
            const modal = document.getElementById('forgotPasswordModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            document.querySelector('#forgotPasswordModal .login-form').reset();
        }
        
        function openLoginFromForgot() {
            closeForgotPasswordModal();
            openLoginModal();
        }
        
        async function handleForgotPassword(event) {
            event.preventDefault();
            const email = document.getElementById('forgot-email').value;
            const submitBtn = event.target.querySelector('.login-submit-btn');
            
            if (!email) {
                showWarningAlert('Thi·∫øu th√¥ng tin!', 'Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ email c·ªßa b·∫°n.');
                return;
            }
            
            // Validate email format
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showWarningAlert('Email kh√¥ng h·ª£p l·ªá!', 'Vui l√≤ng nh·∫≠p ƒë·ªãa ch·ªâ email ƒë√∫ng ƒë·ªãnh d·∫°ng.');
                return;
            }
            
            showLoading(submitBtn);
            
            try {
                const result = await window.firebaseAuth.resetPassword(email);
                
                if (result.success) {
                    showSuccessAlert('Email ƒë√£ ƒë∆∞·ª£c g·ª≠i!', 
                        'Ch√∫ng t√¥i ƒë√£ g·ª≠i link kh√¥i ph·ª•c m·∫≠t kh·∫©u ƒë·∫øn email c·ªßa b·∫°n. Vui l√≤ng ki·ªÉm tra h·ªôp th∆∞ (k·ªÉ c·∫£ th∆∞ m·ª•c spam).', 
                        () => {
                            closeForgotPasswordModal();
                        });
                } else {
                    showErrorAlert('G·ª≠i email th·∫•t b·∫°i!', result.message);
                }
            } catch (error) {
                showErrorAlert('L·ªói h·ªá th·ªëng!', 'ƒê√£ c√≥ l·ªói x·∫£y ra! Vui l√≤ng th·ª≠ l·∫°i sau.');
                console.error('Forgot password error:', error);
            } finally {
                hideLoading(submitBtn);
            }
        }
        
        // Reset Success Modal Functions
        function openResetSuccessModal() {
            const modal = document.getElementById('resetSuccessModal');
            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }
        
        function closeResetSuccessModal() {
            const modal = document.getElementById('resetSuccessModal');
            modal.style.display = 'none';
            document.body.style.overflow = 'auto';
            openLoginModal();
        }
        
        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const loginModal = document.getElementById('loginModal');
            const registerModal = document.getElementById('registerModal');
            const forgotModal = document.getElementById('forgotPasswordModal');
            const successModal = document.getElementById('resetSuccessModal');
            
            if (event.target === loginModal) {
                closeLoginModal();
            } else if (event.target === registerModal) {
                closeRegisterModal();
            } else if (event.target === forgotModal) {
                closeForgotPasswordModal();
            } else if (event.target === successModal) {
                closeResetSuccessModal();
            }
        });
        
        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const loginModal = document.getElementById('loginModal');
                const registerModal = document.getElementById('registerModal');
                const forgotModal = document.getElementById('forgotPasswordModal');
                const successModal = document.getElementById('resetSuccessModal');
                
                if (loginModal.style.display === 'block') {
                    closeLoginModal();
                } else if (registerModal.style.display === 'block') {
                    closeRegisterModal();
                } else if (forgotModal.style.display === 'block') {
                    closeForgotPasswordModal();
                } else if (successModal.style.display === 'block') {
                    closeResetSuccessModal();
                }
            }
        });
        
        // ==========================================
        // DAILY CHECK-IN SYSTEM
        // ==========================================
        
        // Check-in data structure
        const CHECKIN_STORAGE_KEY_PREFIX = 'langhoaruc_checkin_data';
        
        // Diamond rewards for each day
        const DAILY_REWARDS = {
            1: 10, 2: 10, 3: 15, 4: 15, 5: 20, 6: 20, 7: 100,
            8: 25, 9: 25, 10: 30, 11: 30, 12: 35, 13: 35, 14: 200,
            15: 40, 16: 40, 17: 45, 18: 45, 19: 50, 20: 50, 21: 300,
            22: 55, 23: 55, 24: 60, 25: 60, 26: 65, 27: 65, 28: 70, 29: 75, 30: 500
        };
        
        // Get storage key for current user
        function getUserCheckinStorageKey() {
            const user = window.firebaseAuth?.currentUser;
            if (user) {
                return `${CHECKIN_STORAGE_KEY_PREFIX}_${user.uid}`;
            }
            return CHECKIN_STORAGE_KEY_PREFIX; // Fallback for non-logged in users
        }
        
        // Get check-in data from localStorage
        function getCheckinData() {
            const storageKey = getUserCheckinStorageKey();
            const data = localStorage.getItem(storageKey);
            if (data) {
                return JSON.parse(data);
            }
            return {
                totalDiamonds: 0,
                currentStreak: 0,
                totalCheckins: 0,
                checkinDates: [],
                lastCheckinDate: null,
                monthlyCheckins: {}
            };
        }
        
        // Save check-in data to localStorage
        function saveCheckinData(data) {
            const storageKey = getUserCheckinStorageKey();
            localStorage.setItem(storageKey, JSON.stringify(data));
        }
        
        // Get current date string (YYYY-MM-DD)
        function getDateString(date = new Date()) {
            return date.toISOString().split('T')[0];
        }
        
        // Get current month key (YYYY-MM)
        function getMonthKey(date = new Date()) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            return `${year}-${month}`;
        }
        
        // Get month name in Vietnamese
        function getMonthName(date = new Date()) {
            const months = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12'];
            return `${months[date.getMonth()]}/${date.getFullYear()}`;
        }
        
        // Initialize calendar
        function initializeCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            const monthSpan = document.getElementById('currentMonth');
            
            // Check if elements exist (user might not be on check-in section)
            if (!calendarGrid || !monthSpan) {
                return;
            }
            
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const firstDay = new Date(year, month, 1).getDay();
            
            monthSpan.textContent = getMonthName(now);
            calendarGrid.innerHTML = '';
            
            // Add day headers
            const dayHeaders = ['CN', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7'];
            dayHeaders.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-day-header';
                header.textContent = day;
                calendarGrid.appendChild(header);
            });
            
            // Add empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day empty';
                calendarGrid.appendChild(emptyDay);
            }
            
            // Get checked-in data
            const checkinData = getCheckinData();
            const monthKey = getMonthKey(now);
            const monthlyCheckins = checkinData.monthlyCheckins[monthKey] || [];
            const today = now.getDate();
            
            // Add days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                
                const isChecked = monthlyCheckins.includes(day);
                const isToday = day === today;
                const isPast = day < today;
                const isFuture = day > today;
                
                if (isChecked) {
                    dayElement.classList.add('checked');
                }
                if (isToday) {
                    dayElement.classList.add('today');
                }
                if (isPast && !isChecked) {
                    dayElement.classList.add('missed');
                }
                if (isFuture) {
                    dayElement.classList.add('future');
                }
                
                // Special reward days
                if ([7, 14, 21, 30].includes(day)) {
                    dayElement.classList.add('special');
                }
                
                const reward = DAILY_REWARDS[day] || 10;
                
                dayElement.innerHTML = `
                    <span class="day-number">${day}</span>
                    <span class="day-reward">
                        <i class="fas fa-gem"></i> ${reward}
                    </span>
                    ${isChecked ? '<i class="fas fa-check check-mark"></i>' : ''}
                `;
                
                calendarGrid.appendChild(dayElement);
            }
        }
        
        // Update stats display
        function updateStatsDisplay() {
            const data = getCheckinData();
            
            // Safely update elements only if they exist
            const diamondsEl = document.getElementById('totalDiamonds');
            if (diamondsEl) {
                diamondsEl.textContent = data.totalDiamonds.toLocaleString();
            }
            
            const checkinsEl = document.getElementById('totalCheckins');
            if (checkinsEl) {
                checkinsEl.textContent = data.totalCheckins;
            }
        }
        
        // Check if already checked in today
        function hasCheckedInToday() {
            const data = getCheckinData();
            const today = getDateString();
            return data.lastCheckinDate === today;
        }
        
        // Update check-in button state
        function updateCheckinButton() {
            const btn = document.getElementById('checkinBtn');
            const hint = document.getElementById('checkinHint');
            
            // Check if elements exist (user might not be on check-in section)
            if (!btn || !hint) {
                return;
            }
            
            // Check if user is not logged in
            if (!isUserLoggedIn()) {
                btn.disabled = false;
                btn.classList.remove('disabled');
                btn.innerHTML = '<i class="fas fa-sign-in-alt"></i><span>ƒêƒÉng Nh·∫≠p ƒê·ªÉ ƒêi·ªÉm Danh</span>';
                hint.textContent = 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p tr∆∞·ªõc ƒë·ªÉ nh·∫≠n kim c∆∞∆°ng!';
                hint.style.color = '#f59e0b';
                return;
            }
            
            if (hasCheckedInToday()) {
                btn.disabled = true;
                btn.classList.add('disabled');
                btn.innerHTML = '<i class="fas fa-check-circle"></i><span>ƒê√£ ƒêi·ªÉm Danh H√¥m Nay</span>';
                hint.textContent = 'H√£y quay l·∫°i v√†o ng√†y mai nh√©!';
                hint.style.color = '#ffffff';
            } else {
                btn.disabled = false;
                btn.classList.remove('disabled');
                btn.innerHTML = '<i class="fas fa-hand-pointer"></i><span>ƒêi·ªÉm Danh H√¥m Nay</span>';
                hint.textContent = 'Nh·∫•n ƒë·ªÉ nh·∫≠n ph·∫ßn th∆∞·ªüng h√¥m nay!';
                hint.style.color = '#ffffff';
            }
        }
        
        // Get current Firebase user
        function getCurrentFirebaseUser() {
            // Try custom firebaseAuth object first (from firebase-auth.js)
            if (window.firebaseAuth && typeof window.firebaseAuth.getCurrentUser === 'function') {
                return window.firebaseAuth.getCurrentUser();
            }
            
            // Fallback: Check Firebase auth instance directly
            if (window.firebaseAuth && window.firebaseAuth.currentUser) {
                return window.firebaseAuth.currentUser;
            }
            
            return null;
        }
        
        // Check if user is logged in
        function isUserLoggedIn() {
            const user = getCurrentFirebaseUser();
            return user !== null && user !== undefined;
        }
        
        // Sync diamond to Firebase Realtime Database
        async function syncDiamondToFirebase(diamondAmount) {
            try {
                const user = getCurrentFirebaseUser();
                if (!user) {
                    console.error('No user logged in');
                    return false;
                }
                
                const rtdb = window.firebaseRTDB;
                const { ref, get, set } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js');
                
                // Get current user data
                const userRef = ref(rtdb, `Users/${user.uid}`);
                const snapshot = await get(userRef);
                
                if (snapshot.exists()) {
                    const userData = snapshot.val();
                    let currentData;
                    
                    // Parse if data is stored as JSON string
                    if (typeof userData === 'string') {
                        currentData = JSON.parse(userData);
                    } else {
                        currentData = userData;
                    }
                    
                    // Update diamond count
                    const currentDiamond = currentData.Diamond || 0;
                    const newDiamond = currentDiamond + diamondAmount;
                    currentData.Diamond = newDiamond;
                    
                    // Save back to Firebase (as JSON string to match current format)
                    await set(userRef, JSON.stringify(currentData));
                    
                    console.log(`‚úÖ Synced ${diamondAmount} diamonds to Firebase. New total: ${newDiamond}`);
                    return true;
                } else {
                    // Create new user data if not exists
                    const newUserData = {
                        Name: user.displayName || user.email?.split('@')[0] || 'User',
                        Gold: 100,
                        Diamond: diamondAmount,
                        MapInGame: { lstTilemapDetail: [] }
                    };
                    
                    await set(userRef, JSON.stringify(newUserData));
                    
                    console.log(`‚úÖ Created new user with ${diamondAmount} diamonds`);
                    return true;
                }
            } catch (error) {
                console.error('Error syncing diamond to Firebase:', error);
                return false;
            }
        }
        
        // Get diamond count from Firebase
        async function getDiamondFromFirebase() {
            try {
                const user = getCurrentFirebaseUser();
                if (!user) return 0;
                
                const rtdb = window.firebaseRTDB;
                const { ref, get } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js');
                
                const userRef = ref(rtdb, `Users/${user.uid}`);
                const snapshot = await get(userRef);
                
                if (snapshot.exists()) {
                    const userData = snapshot.val();
                    let currentData;
                    
                    if (typeof userData === 'string') {
                        currentData = JSON.parse(userData);
                    } else {
                        currentData = userData;
                    }
                    
                    return currentData.Diamond || 0;
                }
                return 0;
            } catch (error) {
                console.error('Error getting diamond from Firebase:', error);
                return 0;
            }
        }
        
        // Handle check-in action
        async function handleCheckin() {
            // Check if user is logged in first
            if (!isUserLoggedIn()) {
                showWarningAlert(
                    'Y√™u c·∫ßu ƒëƒÉng nh·∫≠p!', 
                    'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ c√≥ th·ªÉ ƒëi·ªÉm danh v√† nh·∫≠n kim c∆∞∆°ng. H√£y ƒëƒÉng nh·∫≠p ngay nh√©!',
                    () => {
                        openLoginModal();
                    }
                );
                return;
            }
            
            if (hasCheckedInToday()) {
                showInfoAlert('ƒê√£ ƒëi·ªÉm danh!', 'B·∫°n ƒë√£ ƒëi·ªÉm danh h√¥m nay r·ªìi. H√£y quay l·∫°i v√†o ng√†y mai nh√©!');
                return;
            }
            
            const now = new Date();
            const today = now.getDate();
            const todayString = getDateString();
            const monthKey = getMonthKey();
            
            const data = getCheckinData();
            const reward = DAILY_REWARDS[today] || 10;
            
            // Update data
            data.totalDiamonds += reward;
            data.totalCheckins += 1;
            data.lastCheckinDate = todayString;
            data.checkinDates.push(todayString);
            
            // Update monthly check-ins
            if (!data.monthlyCheckins[monthKey]) {
                data.monthlyCheckins[monthKey] = [];
            }
            data.monthlyCheckins[monthKey].push(today);
            
            // Save data locally
            saveCheckinData(data);
            
            // Show loading while syncing to Firebase
            showLoadingAlert('ƒêang x·ª≠ l√Ω...', 'ƒêang c·∫≠p nh·∫≠t kim c∆∞∆°ng v√†o t√†i kho·∫£n c·ªßa b·∫°n...');
            
            // Sync to Firebase
            const syncSuccess = await syncDiamondToFirebase(reward);
            
            closeLoadingAlert();
            
            if (syncSuccess) {
                // Show success message
                let message = `B·∫°n nh·∫≠n ƒë∆∞·ª£c ${reward} kim c∆∞∆°ng! üíé\nƒê√£ c·ªông v√†o t√†i kho·∫£n Firebase c·ªßa b·∫°n.`;
                if ([7, 14, 21, 30].includes(today)) {
                    message += '\nüéâ Ph·∫ßn th∆∞·ªüng ƒë·∫∑c bi·ªát!';
                }
                
                showSuccessAlert('ƒêi·ªÉm danh th√†nh c√¥ng!', message, () => {
                    // Update UI
                    initializeCalendar();
                    updateStatsDisplay();
                    updateCheckinButton();
                });
            } else {
                showWarningAlert('L∆∞u √Ω!', `B·∫°n ƒë√£ ƒëi·ªÉm danh th√†nh c√¥ng v√† nh·∫≠n ${reward} kim c∆∞∆°ng.\nTuy nhi√™n c√≥ l·ªói khi ƒë·ªìng b·ªô v·ªõi server. Kim c∆∞∆°ng s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t sau.`);
                // Update UI anyway
                initializeCalendar();
                updateStatsDisplay();
                updateCheckinButton();
            }
        }
        
        // Reset check-in data (for testing)
        function resetCheckinData() {
            if (!isUserLoggedIn()) {
                showWarningAlert('Y√™u c·∫ßu ƒëƒÉng nh·∫≠p!', 'B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p tr∆∞·ªõc ƒë·ªÉ reset d·ªØ li·ªáu.');
                return;
            }
            
            showConfirmAlert(
                'X√°c nh·∫≠n reset d·ªØ li·ªáu?',
                'H√†nh ƒë·ªông n√†y s·∫Ω x√≥a to√†n b·ªô d·ªØ li·ªáu ƒëi·ªÉm danh c·ªßa b·∫°n. B·∫°n c√≥ ch·∫Øc ch·∫Øn?',
                () => {
                    const storageKey = getUserCheckinStorageKey();
                    localStorage.removeItem(storageKey);
                    initializeCalendar();
                    updateStatsDisplay();
                    updateCheckinButton();
                    showSuccessAlert('ƒê√£ reset!', 'D·ªØ li·ªáu ƒëi·ªÉm danh ƒë√£ ƒë∆∞·ª£c reset.');
                }
            );
        }
        
        // Initialize check-in system on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Check if on the page with check-in section
            if (document.getElementById('calendarGrid')) {
                initializeCalendar();
                updateStatsDisplay();
                updateCheckinButton();
                
                // Update at midnight
                const now = new Date();
                const tomorrow = new Date(now);
                tomorrow.setDate(tomorrow.getDate() + 1);
                tomorrow.setHours(0, 0, 0, 0);
                const msUntilMidnight = tomorrow - now;
                
                setTimeout(() => {
                    updateCheckinButton();
                    initializeCalendar();
                    // Set up daily refresh
                    setInterval(() => {
                        updateCheckinButton();
                        initializeCalendar();
                    }, 24 * 60 * 60 * 1000);
                }, msUntilMidnight);
            }
        });
        
        // Make check-in functions globally available
        window.handleCheckin = handleCheckin;
        window.resetCheckinData = resetCheckinData;
        window.updateCheckinButton = updateCheckinButton;
        window.updateStatsDisplay = updateStatsDisplay;
        window.initializeCalendar = initializeCalendar;
        window.getCurrentFirebaseUser = getCurrentFirebaseUser;
        window.isUserLoggedIn = isUserLoggedIn;
        window.syncDiamondToFirebase = syncDiamondToFirebase;
        window.getDiamondFromFirebase = getDiamondFromFirebase;
        
        // ==========================================
        // END DAILY CHECK-IN SYSTEM
        // ==========================================

        // Make functions globally available
        window.openLoginModal = openLoginModal;
        window.closeLoginModal = closeLoginModal;
        window.togglePassword = togglePassword;
        window.handleLogin = handleLogin;
        window.loginWithGoogle = loginWithGoogle;
        
        // Register functions
        window.openRegisterModal = openRegisterModal;
        window.closeRegisterModal = closeRegisterModal;
        window.openLoginFromRegister = openLoginFromRegister;
        window.toggleRegisterPassword = toggleRegisterPassword;
        window.toggleConfirmPassword = toggleConfirmPassword;
        window.handleRegister = handleRegister;
        window.registerWithGoogle = registerWithGoogle;
        window.openTermsModal = openTermsModal;
        
        // Forgot password functions
        window.openForgotPasswordModal = openForgotPasswordModal;
        window.closeForgotPasswordModal = closeForgotPasswordModal;
        window.openLoginFromForgot = openLoginFromForgot;
        window.handleForgotPassword = handleForgotPassword;
        window.openResetSuccessModal = openResetSuccessModal;
        window.closeResetSuccessModal = closeResetSuccessModal;
        
        // Expose debug functions globally
        window.debugCarousel = debugCarousel;
        
        // Make SweetAlert2 functions globally available
        window.showSuccessAlert = showSuccessAlert;
        window.showErrorAlert = showErrorAlert;
        window.showWarningAlert = showWarningAlert;
        window.showInfoAlert = showInfoAlert;
        window.showConfirmAlert = showConfirmAlert;
        window.showLoadingAlert = showLoadingAlert;
        window.closeLoadingAlert = closeLoadingAlert;
        
        // Download functions
        window.downloadGame = downloadGame;
        window.startDownload = startDownload;
        window.showInstallationGuide = showInstallationGuide;
        
        // Test functions
        console.log('üí° Available Commands:');
        console.log('- debugCarousel() - Check carousel status');
        console.log('- openLoginModal() - Open login modal');
        console.log('- downloadGame() - Test download game function');
        console.log('- showSuccessAlert() - Show success notification');
        console.log('- showErrorAlert() - Show error notification');
        console.log('- showWarningAlert() - Show warning notification');
        
        // Scroll to section function
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }

        // Current chapter tracker
        let currentChapter = 1;

        // Show chapter function
        function showChapter(chapterNumber) {
            currentChapter = chapterNumber;
            
            // Hide all chapters
            const chapters = document.querySelectorAll('.story-chapter');
            chapters.forEach(chapter => {
                chapter.classList.remove('active');
            });

            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.chapter-tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected chapter
            const selectedChapter = document.getElementById(`chapter-${chapterNumber}`);
            if (selectedChapter) {
                selectedChapter.classList.add('active');
            }

            // Add active class to selected tab
            const selectedTab = document.querySelector(`.chapter-tab:nth-child(${chapterNumber})`);
            if (selectedTab) {
                selectedTab.classList.add('active');
            }

            // Update navigation buttons
            updateNavButtons();
        }

        // Previous chapter function
        function previousChapter() {
            if (currentChapter > 1) {
                showChapter(currentChapter - 1);
            }
        }

        // Next chapter function
        function nextChapter() {
            if (currentChapter < 6) {
                showChapter(currentChapter + 1);
            }
        }

        // Update navigation buttons state
        function updateNavButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentChapter === 1;
            nextBtn.disabled = currentChapter === 6;
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateNavButtons();
        });

        // Loading Screen Control
        const loadingScreen = document.getElementById('loadingScreen');
        const introVideo = document.getElementById('introVideo');
        
        // Hide loading screen after video ends
        introVideo.addEventListener('ended', () => {
            loadingScreen.classList.add('fade-out');
            setTimeout(() => {
                loadingScreen.style.display = 'none';
            }, 1000);
        });
        
        // Skip loading screen on click
        loadingScreen.addEventListener('click', () => {
            loadingScreen.classList.add('fade-out');
            setTimeout(() => {
                loadingScreen.style.display = 'none';
            }, 1000);
        });

        // Optional: Add scroll effect to navbar
        window.addEventListener('scroll', () => {
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
        });
    </script>

    <!-- AOS Animation Library -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        // Initialize AOS
        AOS.init({
            duration: 800,
            easing: 'ease-out-cubic',
            once: true,
            offset: 100
        });
    </script>
</body>
</html>
